<!DOCTYPE html>
<html>
<head>
    
    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>Knuth–Morris–Pratt algorithm, KMP</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />
    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    </script>
<meta name="description" content="about Data" />
    <link rel="shortcut icon" href="https://gyuhoonk.github.io/assets/built/images/favicon.jpg" type="image/png" />
    <link rel="canonical" href="https://gyuhoonk.github.io/KMP" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="Gyuhoon Kim" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Knuth–Morris–Pratt algorithm, KMP" />
    <meta property="og:description" content="문자열 탐색에서 사용되는 KMP 알고리즘에 대해서 *글의 내용은 KMP : 문자열 검색 알고리즘을 참조했으며 글의 내용 및 구현 코드 모두 작성자 멍멍멍님께서 작성하신 예시, 코드를 그대로 사용했습니다. 작성된 내용을 이해하고, 내 것으로 만드는 과정을 위해 글을 작성했음을 말씀드립니다. 문자열 탐색, O(N*M)의 시간복잡도 어떤 문자열(S)에서 패턴(P)가 몇 번 등장하는지 찾고자 한다고" />
    <meta property="og:url" content="https://gyuhoonk.github.io/KMP" />
    <meta property="og:image" content="https://gyuhoonk.github.io/assets/built/images/kmp-banner.jpeg" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta property="article:author" content="https://www.facebook.com/" />
    <meta property="article:published_time" content="2021-11-06T22:30:00+09:00" />
    <meta property="article:modified_time" content="2021-11-06T22:30:00+09:00" />
    <meta property="article:tag" content="Algorithm" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Knuth–Morris–Pratt algorithm, KMP" />
    <meta name="twitter:description" content="문자열 탐색에서 사용되는 KMP 알고리즘에 대해서 *글의 내용은 KMP : 문자열 검색 알고리즘을 참조했으며 글의 내용 및 구현 코드 모두 작성자 멍멍멍님께서 작성하신 예시, 코드를 그대로 사용했습니다. 작성된 내용을 이해하고, 내 것으로 만드는 과정을 위해 글을 작성했음을 말씀드립니다. 문자열 탐색, O(N*M)의 시간복잡도 어떤 문자열(S)에서 패턴(P)가 몇 번 등장하는지 찾고자 한다고" />
    <meta name="twitter:url" content="https://gyuhoonk.github.io/" />
    <meta name="twitter:image" content="https://gyuhoonk.github.io/assets/built/images/kmp-banner.jpeg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Gyuhoon Kim" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Algorithm" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "Gyuhoon Kim",
        "logo": "https://gyuhoonk.github.io/"
    },
    "url": "https://gyuhoonk.github.io/KMP",
    "image": {
        "@type": "ImageObject",
        "url": "https://gyuhoonk.github.io/assets/built/images/kmp-banner.jpeg",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://gyuhoonk.github.io/KMP"
    },
    "description": "문자열 탐색에서 사용되는 KMP 알고리즘에 대해서 *글의 내용은 KMP : 문자열 검색 알고리즘을 참조했으며 글의 내용 및 구현 코드 모두 작성자 멍멍멍님께서 작성하신 예시, 코드를 그대로 사용했습니다. 작성된 내용을 이해하고, 내 것으로 만드는 과정을 위해 글을 작성했음을 말씀드립니다. 문자열 탐색, O(N*M)의 시간복잡도 어떤 문자열(S)에서 패턴(P)가 몇 번 등장하는지 찾고자 한다고"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="Knuth–Morris–Pratt algorithm, KMP" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="https://gyuhoonk.github.io/">Gyuhoon Kim</a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-about" role="menuitem">
        <a href="/about/">About</a>
    </li>
    <li class="nav-python" role="menuitem">
        <a href="/tag/python/">python</a>
    </li>
    <li class="nav-hadoop" role="menuitem">
        <a href="/tag/hadoop/">hadoop</a>
    </li>
    <li class="nav-scala" role="menuitem">
        <a href="/tag/scala/">scala</a>
    </li>
    <li class="nav-database" role="menuitem">
        <a href="/tag/database/">database</a>
    </li>
    <li class="nav-database" role="menuitem">
        <a href="/tag/datascience/">DataScience</a>
    </li>
    <li class="nav-archive" role="menuitem">
        <a href="/archive.html">All Posts</a>
    </li>
    <li class="nav-archive" role="menuitem">
        <a href="/author_archive.html">Tag</a>
    </li>
</ul>
        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
        </div>
        
            <a class="subscribe-button" href="#subscribe">Subscribe</a>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full  tag-algorithm post tag-algorithm ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime=" 6 November 2021"> 6 November 2021</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/algorithm/'>ALGORITHM</a>
                            
                        
                    
                </section>
                <h1 class="post-full-title">Knuth–Morris–Pratt algorithm, KMP</h1>
            </header>

            <!-- 
            <figure class="post-full-image" style="background-image: url(/assets/built/images/kmp-banner.jpeg)">
            </figure>
             -->

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <p>문자열 탐색에서 사용되는 KMP 알고리즘에 대해서</p>

<p>*글의 내용은 <a href="https://bowbowbow.tistory.com/6">KMP : 문자열 검색 알고리즘</a>을 참조했으며 글의 내용 및 구현 코드 모두 작성자 멍멍멍님께서 작성하신 예시, 코드를 그대로 사용했습니다.</p>

<p>작성된 내용을 이해하고, 내 것으로 만드는 과정을 위해 글을 작성했음을 말씀드립니다.</p>

<h1 id="문자열-탐색-onm의-시간복잡도">문자열 탐색, O(N*M)의 시간복잡도</h1>

<p>어떤 문자열(S)에서 패턴(P)가 몇 번 등장하는지 찾고자 한다고 가정해봅시다.</p>

<table>
  <thead>
    <tr>
      <th>index</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>S</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>D</td>
      <td>E</td>
    </tr>
    <tr>
      <td>P</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>D</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>가장 간단한 방법은 문자열 S의 인덱스 0부터 시작하여 P가 일치하는지 여부를 확인하는 것입니다. 이를 표로 표현해보면 아래와 같을 것입니다.</p>

<p>S의 인덱스 0부터 확인을 시작하여, 1, 2, 3을 차례로 비교하다가 보면,</p>

<table>
  <thead>
    <tr>
      <th>index</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>S</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>D</td>
      <td>E</td>
    </tr>
    <tr>
      <td>P</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>D</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>일치</td>
      <td>O</td>
      <td>O</td>
      <td>O</td>
      <td>X</td>
      <td>X</td>
      <td>X</td>
      <td>O</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>P</td>
      <td> </td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>D</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>일치</td>
      <td> </td>
      <td>X</td>
      <td>X</td>
      <td>X</td>
      <td>X</td>
      <td>X</td>
      <td>X</td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>P</td>
      <td> </td>
      <td> </td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>D</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>일치</td>
      <td> </td>
      <td> </td>
      <td>X</td>
      <td>X</td>
      <td>X</td>
      <td>X</td>
      <td>X</td>
      <td>X</td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>아래처럼 S의 인덱스가 13인 지점에서 패턴 P가 등장함을 확인할 수 있습니다.</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>S</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>D</td>
      <td>E</td>
    </tr>
    <tr>
      <td>P</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>D</td>
      <td> </td>
    </tr>
    <tr>
      <td>일치</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>O</td>
      <td>O</td>
      <td>O</td>
      <td>O</td>
      <td>O</td>
      <td>O</td>
      <td>O</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>문제는 위와 같은 알고리즘의 시간복잡도가 매우 높다는 점입니다.</p>

<p>문자열 S의 길이를 N, P의 길이를 M이라고 했을 때 모든 S 인덱스에 대해 반복문을 실행해야하므로 N번의 실행이 필요하고 S 인덱스 각각에서 P의 길이 M만큼의 검사를 거쳐야 하므로 최종적으로 시간복잡도는 \(O(N*M)\) 로 계산됩니다.</p>

<h1 id="더-빠른-방법-kmp">더 빠른 방법, KMP</h1>

<p>이보다 빠르게, 고작 \(O(N+M)\)의 시간복잡도로 S에서 P를 찾아낼 수 있는 방법이 있습니다. KMP(Knuth–Morris–Pratt) 알고리즘이 바로 그것입니다. KMP 알고리즘의 기본 아이디어는 <strong>패턴을 찾기 위해 수행한 비교연산에서 얻은 정보를 활용하는 것</strong>입니다.</p>

<p>KMP 알고리즘을 위해서는 접두사(prefix)와 접미사(suffix), 그리고 이들을 비교하여 작성되는 Pi 배열에 대해 이해하고 있어야 합니다.</p>

<h2 id="prefix-suffix-pi">Prefix, Suffix, Pi</h2>

<p>위에서 예로 들었던 P (ABCDABD)를 예로 들어보겠습니다.</p>

<p>먼저 접두사는 앞에서부터 시작해서 만들 수 있는 문자열의 부분, 반대로 접미사는 뒤에서 시작해서 만들 수 있는 문자열의 부분을 의미합니다.</p>

<p>따라서 ABCDABD의 접미사와 접두사는 아래와 같습니다.</p>

<table>
  <thead>
    <tr>
      <th>length</th>
      <th>Prefix</th>
      <th>Suffix</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>A</td>
      <td>D</td>
    </tr>
    <tr>
      <td>2</td>
      <td>AB</td>
      <td>BD</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ABC</td>
      <td>ABD</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ABCD</td>
      <td>DABD</td>
    </tr>
    <tr>
      <td>5</td>
      <td>ABCDA</td>
      <td>CDABD</td>
    </tr>
    <tr>
      <td>6</td>
      <td>ABCDAB</td>
      <td>BCDABD</td>
    </tr>
    <tr>
      <td>7</td>
      <td>ABCDABD</td>
      <td>ABCDABD</td>
    </tr>
  </tbody>
</table>

<p>Pi 배열은 이러한 개념을 이용하여 만들어지는 배열입니다. 정의는 아래와 같습니다.</p>

<p><code class="language-plaintext highlighter-rouge">Pi[i] = 문자열 인덱스 0~i로 만들어진 부분 문자열(P[0~i]) 중에서 prefix와 suffix가 같은 경우 중 길이의 최댓값, 단 prefix/suffix가 P[0~i]와 같은 경우는 제외</code></p>

<p>P (ABCDABD)에 대해서 Pi 배열이 만들어지는 과정을 확인하면 아래와 같습니다.</p>

<table>
  <thead>
    <tr>
      <th>idx</th>
      <th>부분문자열 P[0~i]</th>
      <th>Prefix</th>
      <th>Suffix</th>
      <th>Pi[idx]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>A</td>
      <td>X</td>
      <td>X</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>AB</td>
      <td>A</td>
      <td>B</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>ABC</td>
      <td>A, AB</td>
      <td>C, BC</td>
      <td>0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ABCD</td>
      <td>A, AB, ABC</td>
      <td>D, CD, BCD</td>
      <td>0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ABCDA</td>
      <td><strong>A</strong>, AB, ABC, ABCD</td>
      <td><strong>A</strong>, DA, CDA, BCDA</td>
      <td>1</td>
    </tr>
    <tr>
      <td>5</td>
      <td>ABCDAB</td>
      <td>A, <strong>AB</strong>, ABC, ABCD, ABCDA</td>
      <td>B, <strong>AB</strong>, DAB, CDAB, BCDAB</td>
      <td>2</td>
    </tr>
    <tr>
      <td>6</td>
      <td>ABCDABD</td>
      <td>A, AB, ABC, ABCD, ABCDA, ABCDAB</td>
      <td>D, BD, ABD, DABD, CDABD, BCDABD</td>
      <td>0</td>
    </tr>
  </tbody>
</table>

<p>Pi배열의 정의에 의해 <code class="language-plaintext highlighter-rouge">Pi[0]</code>은 항상 0으로 고정됩니다. 그리고 <code class="language-plaintext highlighter-rouge">Pi[1]</code>부터 표에서 보이는 비교를 통해 조건을 만족하는 경우 중 길이가 최댓값인 경우를 Pi 배열로 저장합니다.</p>

<p>P (ababa)를 가지고  Pi배열을 다시 생성해보겠습니다.</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th>부분문자열 P[0~i]</th>
      <th>Prefix</th>
      <th>Suffix</th>
      <th>Pi[idx]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>a</td>
      <td>X</td>
      <td>X</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ab</td>
      <td>a</td>
      <td>b</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>aba</td>
      <td><strong>a</strong>, ab</td>
      <td><strong>a</strong>, ba</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>abab</td>
      <td>a, <strong>ab</strong>, aba</td>
      <td>b, <strong>ab</strong>, bab</td>
      <td>2</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ababa</td>
      <td>a, ab, <strong>aba</strong>, abab</td>
      <td>a, ba, <strong>aba</strong>, baba</td>
      <td>3</td>
    </tr>
  </tbody>
</table>

<h2 id="비교에-의해-발생한-정보를-활용하는-방법">비교에 의해 발생한 정보를 활용하는 방법</h2>

<p>문자열 S(ABCDABCDABEE)에서 패턴 P(ABCDABE)를 찾는다고 가정해보겠습니다.
참고로, 패턴 P의 Pi 배열은 아래와 같습니다.</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th>부분문자열 P[0~i]</th>
      <th>Prefix</th>
      <th>Suffix</th>
      <th>Pi[idx]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>A</td>
      <td>X</td>
      <td>X</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>AB</td>
      <td>A</td>
      <td>B</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>ABC</td>
      <td>A, AB</td>
      <td>C, BC</td>
      <td>0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ABCD</td>
      <td>A, AB, ABC</td>
      <td>D, CD, BCD</td>
      <td>0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ABCDA</td>
      <td>A, AB, ABC, ABCD</td>
      <td>A, DA, CDA, BCDA</td>
      <td>0</td>
    </tr>
    <tr>
      <td>5</td>
      <td>ABCDAB</td>
      <td>A, <strong>AB</strong>, ABC, ABCD, ABCDA</td>
      <td>B, <strong>AB</strong>, DAB, CDAB, BCDAB</td>
      <td>2</td>
    </tr>
    <tr>
      <td>6</td>
      <td>ABCDABE</td>
      <td>A, AB, ABC, ABCD, ABCDA, ABCDAB</td>
      <td>E, BE, ABE, DABE, CDABE, BCDABE</td>
      <td>0</td>
    </tr>
  </tbody>
</table>

<p>문자열 S의 인덱스 0에서 비교를 수행할 때 우리가 얻는 정보는 아래의 <code class="language-plaintext highlighter-rouge">일치</code> 행과 같습니다.</p>

<table>
  <thead>
    <tr>
      <th>index</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>S</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>E</td>
      <td>E</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>P</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>E</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>일치</td>
      <td>O</td>
      <td>O</td>
      <td>O</td>
      <td>O</td>
      <td>O</td>
      <td>O</td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>이 정보를 이용한다면, 다음 S에서 검색해야할 인덱스는 1이 아니라 4가 됩니다. 즉, <strong>인덱스 1~3을 시작으로 하는 케이스는 검색할 필요도 없다</strong>는 정보를 얻을 수 있습니다. 이는 Pi 배열의 값을 이용했기 때문입니다. 이러한 사고의 흐름은 아래와 같습니다.</p>

<ol>
  <li>
    <p>패턴 P의 인덱스 5까지 일치함을 확인하였고, 인덱스 6에서 불일치가 발생했습니다 (현재 인덱스 = 6).</p>
  </li>
  <li>
    <p>지금까지 일치한 P의 부분배열 <code class="language-plaintext highlighter-rouge">P[0~5] = ABCDAB</code>는 prefix과 suffix가 일치하는 최댓값 길이는 2(<strong>AB</strong>CD<strong>AB</strong>)입니다.(이는  <code class="language-plaintext highlighter-rouge">Pi[5]=2</code> 로 바로 확인됩니다)</p>

    <ol>
      <li>패턴 P는 연속으로 일치하는 5개로 이루어진 부분배열(ABCDAB)의 suffix(ABCD<strong>AB</strong>)의 다음 인덱스부터 검색을 시작해야합니다.</li>
      <li>왜냐하면 prefix = suffix이므로 <code class="language-plaintext highlighter-rouge">S[4~5]</code> (<code class="language-plaintext highlighter-rouge">P[0~5]</code>의 suffix)는 반드시 <code class="language-plaintext highlighter-rouge">P[0~1]</code> (<code class="language-plaintext highlighter-rouge">P[0~5]</code>의 prefix)와 같음을 알고 있기 때문입니다.</li>
      <li>따라서, <code class="language-plaintext highlighter-rouge">P[2~6]</code>, <code class="language-plaintext highlighter-rouge">S[6~10]</code>을 비교하게 됩니다.</li>
    </ol>
  </li>
  <li>
    <p>이는 P와 일치하는 배열을 찾기 위해서는 S에서 <code class="language-plaintext highlighter-rouge">AB</code>로 시작하는 인덱스에서 시작해야하기 때문이며,  <strong><code class="language-plaintext highlighter-rouge">S[1]~S[3]</code>은 AB로 시작하지 않음</strong>을 인덱스 0에서의 비교를 통해 이미 습득했기 때문입니다.</p>

    <ol>
      <li>
        <p><code class="language-plaintext highlighter-rouge">S[1~2]=AB, S[2~3]=AB, S[3~4]=AB</code>인 경우에는 일치 비교 결과가 현재와는 다를 것입니다.</p>
      </li>
      <li>
        <table>
          <thead>
            <tr>
              <th>index</th>
              <th>0</th>
              <th>1</th>
              <th>2</th>
              <th>3</th>
              <th>4</th>
              <th>5</th>
              <th>6</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>P</td>
              <td>A</td>
              <td>B</td>
              <td>C</td>
              <td>D</td>
              <td>A</td>
              <td>B</td>
              <td>E</td>
            </tr>
            <tr>
              <td>IF S[1]=A</td>
              <td>A(O)</td>
              <td>B-&gt;<strong>A</strong>(X)</td>
              <td>C-&gt;<strong>B</strong>(X)</td>
              <td>D(O)</td>
              <td>A(O)</td>
              <td>B(O)</td>
              <td>C(X)</td>
            </tr>
            <tr>
              <td>IF S[2]=A</td>
              <td>A(O)</td>
              <td>B(O)</td>
              <td>C-&gt;<strong>A</strong>(X)</td>
              <td>D-&gt;<strong>B</strong>(X)</td>
              <td>A(O)</td>
              <td>B(O)</td>
              <td>C(O)</td>
            </tr>
            <tr>
              <td>IF S[3]=A</td>
              <td>A(O)</td>
              <td>B(O)</td>
              <td>C(O)</td>
              <td>D-&gt;<strong>A</strong>(X)</td>
              <td>A-&gt;<strong>B</strong>(X)</td>
              <td>B(O)</td>
              <td>C(O)</td>
            </tr>
          </tbody>
        </table>
      </li>
    </ol>
  </li>
</ol>

<p>이러한 정보들을 종합해보았을 때, 아래와 같이 인덱스 <strong>6번</strong>부터 5번의 추가 비교가 이루어지고 S에서 P를 찾게됩니다.</p>

<table>
  <thead>
    <tr>
      <th>index</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>S</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td><strong>C</strong></td>
      <td><strong>D</strong></td>
      <td><strong>A</strong></td>
      <td><strong>B</strong></td>
      <td><strong>E</strong></td>
      <td>E</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>P</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>A</td>
      <td>B</td>
      <td><strong>C</strong></td>
      <td><strong>D</strong></td>
      <td><strong>A</strong></td>
      <td><strong>B</strong></td>
      <td><strong>E</strong></td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>일치</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>O</td>
      <td>O</td>
      <td>O</td>
      <td>O</td>
      <td>O</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h1 id="kmp-알고리즘을-이용한-pi-배열-생성">KMP 알고리즘을 이용한 Pi 배열 생성</h1>

<p>KMP 알고리즘을 적용하여 문자열을 빠르게 탐색하기 위해서는 미리 Pi 배열을 생성해놓아야합니다. 그러나 1) 각 부분배열에 대해 2) 모든 prefix와 suffix를 찾고 3) 비교하여 길이가 최대인 경우를 찾는 방법은 시간복잡도가 꽤 큽니다(\(O(m * m * m)\)).</p>

<p>패턴 P를 스스로와 비교하는 KMP 알고리즘을 통해 $ O(m) $ 시간복잡도로 Pi 배열을 생성할 수 있습니다.</p>

<p>예를 들어, P(ABCDABEA)에 대해서 KMP 알고리즘을 적용하여 Pi 배열을 만드는 과정을 살펴보겠습니다.</p>

<p>먼저, <code class="language-plaintext highlighter-rouge">P[0]</code>은 항상 0으로 시작합니다.</p>

<table>
  <thead>
    <tr>
      <th>index</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Pi</td>
      <td>0</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>P</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>E</td>
      <td>A</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>P_</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>E</td>
      <td>A</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>P_의 인덱스를 1 이동시키고, 1번 인덱스를 비교합니다. <code class="language-plaintext highlighter-rouge">P[1] != P_[0]</code>을 확인했으므로, <code class="language-plaintext highlighter-rouge">Pi[1] = 0</code> 을 입력합니다.</p>

<table>
  <thead>
    <tr>
      <th>index</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Pi</td>
      <td>0</td>
      <td><strong>0</strong></td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>P</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>E</td>
      <td>A</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>P_</td>
      <td> </td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>E</td>
      <td>A</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>일치</td>
      <td> </td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>다시, P_의 인덱스를 1 이동시킵니다. 여전히 <code class="language-plaintext highlighter-rouge">P[2] != P_[0]</code> 이므로 <code class="language-plaintext highlighter-rouge">Pi[2 ] = 0</code> 을 입력합니다.</p>

<p>P_의 시작 인덱스가 4가 될 때까지 겹치는 부분이 없으므로 생략하고 넘어가겠습니다.</p>

<table>
  <thead>
    <tr>
      <th>index</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Pi</td>
      <td>0</td>
      <td>0</td>
      <td><strong>0</strong></td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>P</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>E</td>
      <td>A</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>P_</td>
      <td> </td>
      <td> </td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>E</td>
      <td>A</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>일치</td>
      <td> </td>
      <td> </td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>이제 P_는 인덱스 4부터 시작합니다. <code class="language-plaintext highlighter-rouge">P[4] = P_[0]</code> 으로 일치하므로 <code class="language-plaintext highlighter-rouge">Pi[4] = 1</code>을 입력합니다.</p>

<table>
  <thead>
    <tr>
      <th>index</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Pi</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td><strong>1</strong></td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>P</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>E</td>
      <td>A</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>P_</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>E</td>
      <td>A</td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>O</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>이전 비교에서 일치했으므로 P_를 이동시키지 않습니다. 그리고 <code class="language-plaintext highlighter-rouge">P[5] = P_[1]</code> 으로 일치합니다. 단, <code class="language-plaintext highlighter-rouge">Pi[4] = 1</code>이므로,  <code class="language-plaintext highlighter-rouge">Pi[5] = Pi[4] + 1</code>을 입력합니다.</p>

<table>
  <thead>
    <tr>
      <th>index</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Pi</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td><strong>1</strong></td>
      <td><strong>2</strong></td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>P</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>E</td>
      <td>A</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>P_</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>E</td>
      <td>A</td>
      <td> </td>
    </tr>
    <tr>
      <td>일치</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>O</td>
      <td>O</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>이전 비교에서 일치했으므로 P_를 이동시키지 않습니다. 그러나,  <code class="language-plaintext highlighter-rouge">P[6] != P_[2]</code>이라서, <code class="language-plaintext highlighter-rouge">Pi[6]=0</code>을 입력합니다.</p>

<table>
  <thead>
    <tr>
      <th>index</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Pi</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td><strong>1</strong></td>
      <td><strong>2</strong></td>
      <td><strong>0</strong></td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>P</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>E</td>
      <td>A</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>P_</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>E</td>
      <td>A</td>
      <td> </td>
    </tr>
    <tr>
      <td>일치</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>이전 비교가 불일치했으므로, P_ 배열을 이동시켜야합니다. <code class="language-plaintext highlighter-rouge">P[7]</code>과 <code class="language-plaintext highlighter-rouge">P_[0]</code>이 비교될 수 있도록 배열을 이동시킵니다. <code class="language-plaintext highlighter-rouge">P[7] = P_[0]</code>이므로 <code class="language-plaintext highlighter-rouge">Pi[7]=1</code>을 입력하고 비교가 종료됩니다.</p>

<table>
  <thead>
    <tr>
      <th>index</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Pi</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td><strong>1</strong></td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>P</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
      <td>E</td>
      <td>A</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>P_</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>D</td>
      <td>A</td>
      <td>B</td>
    </tr>
    <tr>
      <td>일치</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>O</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h1 id="code">Code</h1>

<p>아래 코드는 <a href="https://www.acmicpc.net/problem/1786">1786 찾기</a>의 풀이입니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sys</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">stdin</span><span class="p">.</span><span class="n">readline</span><span class="p">().</span><span class="n">rstrip</span><span class="p">()</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">stdin</span><span class="p">.</span><span class="n">readline</span><span class="p">().</span><span class="n">rstrip</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">getPi</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">pi</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="p">:</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">P</span><span class="p">[</span><span class="n">j</span><span class="p">]):</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">pi</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">P</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="p">:</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">pi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
    <span class="k">return</span> <span class="n">pi</span>

<span class="n">pi</span> <span class="o">=</span> <span class="n">getPi</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">KMP</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">answer</span> <span class="o">=</span> <span class="p">{</span><span class="s">"count"</span> <span class="p">:</span> <span class="mi">0</span> <span class="p">,</span>
             <span class="s">"index"</span> <span class="p">:</span> <span class="p">[]}</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">:</span>  <span class="c1"># String Index는 계속 진행
</span>        <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">P</span><span class="p">[</span><span class="n">j</span><span class="p">]):</span> <span class="c1"># Pattern Index를 결정하는 코드 블록
</span>            <span class="n">j</span> <span class="o">=</span> <span class="n">pi</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Prefix = Suffix인 인덱스의 다음 인덱스 (pi[j-1]가 개수이기 때문에 다음 인덱스 역할)
</span>        <span class="k">if</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">P</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">m</span><span class="o">-</span><span class="mi">1</span> <span class="p">:</span> <span class="c1"># Pattern을 발견함
</span>                <span class="n">answer</span><span class="p">[</span><span class="s">'count'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">answer</span><span class="p">[</span><span class="s">'index'</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">pi</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="c1"># Pattern Index 결정
</span>            <span class="k">else</span> <span class="p">:</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">answer</span>

<span class="n">answer</span> <span class="o">=</span> <span class="n">KMP</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">answer</span><span class="p">[</span><span class="s">'count'</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s">' '</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">answer</span><span class="p">[</span><span class="s">'index'</span><span class="p">]))))</span>
</code></pre></div></div>


                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            <!-- 
                <section class="subscribe-form">
                    <h3 class="subscribe-form-title">Subscribe to Gyuhoon Kim</h3>
                    <p>Get the latest posts delivered right to your inbox</p>
                    <form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email"  placeholder="youremail@example.com" />
    </div>
    <button class="" type="submit" disabled><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>

                </section>
             -->

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/assets/built/images/GyuhoonK.jpg" alt="GyuhoonK" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/author/GyuhoonK">GyuhoonK</a></h4>
                                
                                    <p>Read <a href="/author/GyuhoonK">more posts</a> by this author.</p>
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/author/GyuhoonK">Read More</a>
                        </div>
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            
                <section class="post-full-comments">
                    <div id="disqus_thread"></div>
                    <script>
                        var disqus_config = function () {
                            var this_page_url = 'https://gyuhoonk.github.io/KMP';
                            var this_page_identifier = '/KMP';
                            var this_page_title = 'Knuth–Morris–Pratt algorithm, KMP';
                        };
                        (function() {
                            var d = document, s = d.createElement('script');
                            s.src = 'https://xxxxxxxx.disqus.com/embed.js';
                            s.setAttribute('data-timestamp', +new Date());
                            (d.head || d.body).appendChild(s);
                        })();
                    </script>
                </section>
            

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/melt-in-pyspark">
                <div class="post-card-image" style="background-image: url(/assets/built/images/melt-image.jpg)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/melt-in-pyspark">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Hadoop</span>
                            
                        
                    

                    <h2 class="post-card-title">Melt in Pyspark</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p>pyspark로 melt function 구현하기

</p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/built/images/GyuhoonK.jpg" alt="GyuhoonK" />
                        
                        <span class="post-card-author">
                            <a href="/author/GyuhoonK/">GyuhoonK</a>
                        </span>
                    
                
                <span class="reading-time">
                    
                    
                      3 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/threading-in-python">
                <div class="post-card-image" style="background-image: url(/assets/built/images/thread-banner.jpeg)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/threading-in-python">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Python</span>
                            
                        
                    

                    <h2 class="post-card-title">Threading in Python</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p>Python - Thread, Mutex, Semaphore

</p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/built/images/GyuhoonK.jpg" alt="GyuhoonK" />
                        
                        <span class="post-card-author">
                            <a href="/author/GyuhoonK/">GyuhoonK</a>
                        </span>
                    
                
                <span class="reading-time">
                    
                    
                      5 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://gyuhoonk.github.io/">
            
            <span>Gyuhoon Kim</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">Knuth–Morris–Pratt algorithm, KMP</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=Knuth%E2%80%93Morris%E2%80%93Pratt+algorithm%2C+KMP&amp;url=https://gyuhoonk.github.ioKMP"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://gyuhoonk.github.ioKMP"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://gyuhoonk.github.io/">Gyuhoon Kim</a> &copy; 2021</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyllt/jasper2" target="_blank" rel="noopener">Jasper2</a></section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    
                    
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
        <div id="subscribe" class="subscribe-overlay">
            <a class="subscribe-overlay-close" href="#"></a>
            <div class="subscribe-overlay-content">
                
                <h1 class="subscribe-overlay-title">Subscribe to Gyuhoon Kim</h1>
                <p class="subscribe-overlay-description">Stay up to date! Get all the latest &amp; greatest posts delivered straight to your inbox</p>
                <form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email"  placeholder="youremail@example.com" />
    </div>
    <button class="" type="submit" disabled><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>

            </div>
        </div>
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-xxxxxxxx-x', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>
<script type="text/javascript" async
	src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
	extensions: ["tex2jax.js"],
	jax: ["input/TeX", "output/HTML-CSS"],
	tex2jax: {
		inlineMath: [ ['$','$'], ["\\(","\\)"] ],
		displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
		processEscapes: true
	},
	"HTML-CSS": { availableFonts: ["TeX"] }
});
</script>
    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->
    <!-- math LaTex-->
    
</body>
</html>
