<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2021-10-24T17:26:48+09:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Gyuhoon Kim</title><subtitle>about Data</subtitle><entry><title type="html">Merge Files in Hive</title><link href="http://localhost:4000/hive-merge-query" rel="alternate" type="text/html" title="Merge Files in Hive" /><published>2021-10-13T22:30:00+09:00</published><updated>2021-10-13T22:30:00+09:00</updated><id>http://localhost:4000/hive-merge-query</id><content type="html" xml:base="http://localhost:4000/hive-merge-query">&lt;p&gt;Hiveì—ì„œ ì‘ì€ ìš©ëŸ‰ì˜ íŒŒì¼ë“¤ì„ í•˜ë‚˜ì˜ íŒŒì¼ë¡œ í•©ì¹˜ê¸°&lt;/p&gt;

&lt;h1 id=&quot;blocks-in-hdfs&quot;&gt;Blocks in HDFS&lt;/h1&gt;

&lt;p&gt;ë°ì´í„°ëŠ” HDFS ìƒì—ì„œ Blockì´ë¼ëŠ” ë‹¨ìœ„ë¡œ ì €ì¥ë©ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ í•˜ë‚˜ì˜ Blockì— 128MBë¥¼ ì €ì¥í•©ë‹ˆë‹¤. ë”°ë¼ì„œ Block Size, 128MBë¥¼ ë„˜ëŠ” ë°ì´í„°ëŠ” ì—¬ëŸ¬ ê°œì˜ Blockìœ¼ë¡œ ìª¼ê°œì„œ ì €ì¥í•˜ê²Œ ë©ë‹ˆë‹¤. ì•„ë˜ëŠ” 518MB íŒŒì¼ì´ Blockìœ¼ë¡œ ìª¼ê°œì ¸ì„œ ì €ì¥ë˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/hdfs-blocks.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ê°  Blockì€ ì•ˆì •ì„±ì„ ìœ„í•´ ì„œë¡œ ë‹¤ë¥¸ ë…¸ë“œì— Block replicationì„ ì €ì¥í•˜ê³ , Name Nodeì—ëŠ” í•´ë‹¹ Fileì˜ block locationê³¼ ê°™ì€ meta dataë¥¼ ì €ì¥í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ í•œ Data Nodeê°€ ì‘ë™í•˜ì§€ ì•Šë”ë¼ë„, ì›ë³¸ ë°ì´í„°ë¥¼ ë³µêµ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í¬ìŠ¤íŒ…ì—ì„œ ë‹¤ë£¨ê³ ìí•˜ëŠ” ë‚´ìš©ì€ ì•„ë‹ˆë‹ˆ ê°„ë‹¨íˆ ì´ë¯¸ì§€ë¡œ ëŒ€ì²´í•˜ê³  ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/Block-Replication-in-Hadoop.png&quot; alt=&quot;image&quot; style=&quot;zoom:150%;&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;read-file--read-blocks--hdfs-io&quot;&gt;Read File = Read Blocks = HDFS I/O&lt;/h1&gt;

&lt;p&gt;HDFSì—ì„œ í•˜ë‚˜ì˜ Fileì„ ì½ì„ ë•Œ, í•´ë‹¹ Fileì— í•´ë‹¹í•˜ëŠ” Blockë“¤ì„ ì½ì–´ë“¤ì—¬ì˜µë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì•„ë˜ ê·¸ë¦¼ì²˜ëŸ¼ File Aë¥¼ ì½ê³ ì í•œë‹¤ë©´, File Aê°€ ìª¼ê°œì–´ ì €ì¥ë˜ì–´ìˆëŠ” Block1, Block2, Block3, Block4ë¥¼ ì½ì–´ë“¤ì—¬ì˜¤ëŠ” ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/file-reading-hive.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë§Œì•½ File Aì— í•´ë‹¹í•˜ëŠ” Blockì´ ë§ë‹¤ë©´ ë” ë§ì€ Blockì„ ì½ì–´ì™€ì•¼í•˜ê³  ì´ëŠ” ë” ë§ì€ HDFS I/Oê°€ ë°œìƒí•¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;bad-case--file-size-is-less-than-block-size&quot;&gt;Bad Case : File Size is Less than Block Size&lt;/h1&gt;

&lt;p&gt;HDFSì— ì €ì¥í•˜ê³ ì í•˜ëŠ” Fileì´ Block Size(128MB)ë³´ë‹¤ ì‘ìœ¼ë©´ ì´ëŸ¬í•œ HDFS I/OëŠ” ë” ë§ì´ ë°œìƒí•˜ê²Œë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì˜ˆë¥¼ ë“¤ì–´, ìš°ë¦¬ëŠ” 500MB ì§œë¦¬ ë°ì´í„°ë¥¼ ì €ì¥í•œë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤.&lt;/p&gt;

&lt;p&gt;í•´ë‹¹ íŒŒì¼ì€ 500MB ì§œë¦¬ íŒŒì¼ &lt;strong&gt;í•˜ë‚˜&lt;/strong&gt;ë¡œ ì €ì¥í•  ìˆ˜ë„ ìˆê³ , 50MBì§œë¦¬ íŒŒì¼ &lt;strong&gt;10ê°œ&lt;/strong&gt;ë¡œ ì €ì¥í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì–´ë–»ê²Œ ì €ì¥í•˜ëŠ” ê²ƒì´ ë” íš¨ìœ¨ì ì¼ê¹Œìš”?&lt;/p&gt;

&lt;p&gt;ë¹„êµ í¸ì˜ë¥¼ ìœ„í•´ ê° Blockë“¤ì´ ëª¨ë‘ ë‹¤ë¥¸ DataNodeì— ì €ì¥ë˜ì—ˆë‹¤ê³  ê°€ì •í•˜ê³  ë¹„êµí•´ë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;case1--only-1-file-size-is-500mb&quot;&gt;Case1 : only 1 File, Size is 500MB&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/hdfs-case1.png&quot; alt=&quot;image&quot; style=&quot;zoom:150%;&quot; /&gt;500MB ì§œë¦¬ íŒŒì¼ í•˜ë‚˜ë¡œ HDFSì— ì €ì¥í•  ê²½ìš°, File AëŠ” ìœ„ ê·¸ë¦¼ì²˜ëŸ¼ 4ê°œì˜ blockìœ¼ë¡œ ìª¼ê°œì§‘ë‹ˆë‹¤. ë˜í•œ, NameNodeëŠ” File Aì˜ ë©”íƒ€ ë°ì´í„°ë¥¼ í•˜ë‚˜ ì €ì¥í•©ë‹ˆë‹¤. ì´ë•Œ HDFS I/OëŠ” 4ë²ˆ ë°œìƒí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;case2--10-files-each-size-is-50mb&quot;&gt;Case2 : 10 Files, each Size is 50MB&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/hdfs-case2.png&quot; alt=&quot;image&quot; style=&quot;zoom:150%;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;File Aë¥¼ Block Sizeì¸ 128MBë³´ë‹¤ ì‘ì€ 50MB íŒŒì¼ 10ê°œë¡œ ìª¼ê°œì„œ ì €ì¥í•  ê²½ìš°, ìœ„ ê·¸ë¦¼ì²˜ëŸ¼ ê° 10ê°œ Fileì€ ê°ê° 50MB í¬ê¸°ì˜ Blockì— ì €ì¥ë©ë‹ˆë‹¤. ë”°ë¼ì„œ, HDFS I/O ëŠ” 10ë²ˆ ë°œìƒí•˜ê²Œë©ë‹ˆë‹¤. ë˜í•œ, NameNodeëŠ” File A-1ë¶€í„° File A-10ê¹Œì§€ 10ê°œ íŒŒì¼ì— ëŒ€í•œ ë©”íƒ€ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ìœ„ ê·¸ë¦¼ì„ ê°„ë‹¨í•˜ê²Œ ë¹„êµí•´ë³´ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Â &lt;/th&gt;
      &lt;th&gt;# HDFS I/O(Data Node)&lt;/th&gt;
      &lt;th&gt;# MetaData in NameNode&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Case1&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Case2&lt;/td&gt;
      &lt;td&gt;10&lt;/td&gt;
      &lt;td&gt;10&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;ë¹„êµë¥¼ ìœ„í•´ ëª¨ë“  Blockì´ ë‹¤ë¥¸  Data Nodeì— ì €ì¥ë˜ì–´ ìˆë‹¤ê³  ê°€ì •í–ˆì§€ë§Œ, ì‹¤ì œ ìƒí™©ì—ì„œëŠ” í•˜ë‚˜ì˜ Data Nodeì— ì—¬ëŸ¬ Blockì´ ì €ì¥ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—  HDFS I/OëŠ” ìœ„ ìˆ˜ì¹˜ë³´ë‹¤ ë‚®ì„ ê²ƒì…ë‹ˆë‹¤. ì¦‰, ìœ„ ìƒí™©ì²˜ëŸ¼ ëª¨ë“  Blockì´ ê°ê¸° ë‹¤ë¥¸ Data Nodeì— ì €ì¥ëœ ìƒí™©ì€ ìµœì•…ì˜ ê²½ìš°ë¼ê³  ìƒê°í•˜ì‹œë©´ ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŸ¬í•œ ê°€ì •ì„ ì œê±°í•˜ë”ë¼ë„ Block AccessëŠ” Case1ê³¼ Case2ê°€ ê°ê° 4,10ìœ¼ë¡œ ë³€í•¨ ì—†ì„ ê²ƒì…ë‹ˆë‹¤. ë”°ë¼ì„œ ìš°ë¦¬ëŠ” Block Sizeë³´ë‹¤ ì‘ì€ íŒŒì¼ì´ ì €ì¥ë˜ëŠ” ê²ƒì„ ì§€ì–‘í•´ì•¼í•¨ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;when-is-file-size-less-than-block-size-&quot;&gt;When is File size Less than Block size ?&lt;/h1&gt;

&lt;p&gt;ê·¸ëŸ¬ë©´ File Sizeê°€ 128MBë³´ë‹¤ ì‘ê²Œ ì €ì¥ë˜ëŠ” ê²½ìš°ëŠ” ì™œ ê·¸ë¦¬ê³  ì–¸ì œ ë°œìƒí•˜ëŠ” ê²ƒì¼ê¹Œìš”? ì´ëŠ” Tez, Yarn ìŠ¤ì¼€ì¥´ëŸ¬ì˜ ë™ì‘ ì›ë¦¬ì™€ ê´€ë ¨ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/hql-on-tez.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ìœ„ ê·¸ë¦¼ì²˜ëŸ¼, Tezë¥¼ ì´ìš©í•œ HQL êµ¬ë¬¸ì€ ìµœì¢…ì ìœ¼ë¡œ Reducerì—ì„œ ê²°ê³¼ë¥¼ ì¢…í•©í•˜ì—¬ outputì„ ë‚´ë†“ìŠµë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ File 1ê°œë§Œ ë‚˜ì™€ì•¼í•˜ëŠ” ê²ƒ ì•„ë‹Œê°€? ë¼ê³  ìƒê°í•  ìˆ˜ ìˆì§€ë§Œ, í• ë‹¹ ë°›ì€ ìì› ë‚´ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ì—¬ëŸ¬ ê°œì˜ Ruducerë¥¼ ìƒì„±í•˜ì—¬ ì‘ì—…ì„ ì‹¤í–‰í•˜ê²Œ ë˜ê³  ê° Reducerë“¤ì´ ì²˜ë¦¬í•œ ê²°ê³¼ë¥¼ HDFSì— ì €ì¥í•©ë‹ˆë‹¤. ì´ ê³¼ì •ì—ì„œ ê°ê°ì˜ Reducerê°€ ì²˜ë¦¬í•˜ëŠ” ë°ì´í„°ì˜ ì–‘ì´ ì ë‹¤ë©´, output sizeê°€ block sizeë³´ë‹¤ ì ì€ fileì„ writeí•  ìˆ˜ë„ ìˆê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;Sparkì˜ file ê°œìˆ˜ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë‹¤ë¥¸ ì˜µì…˜ì„ ì§€ì •í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;spark.default.parallelism&lt;/code&gt; ì— ì˜í•´ ê²°ì •ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;[default]&lt;/p&gt;

  &lt;p&gt;For distributed shuffle operations like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;reduceByKey&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;join&lt;/code&gt;, the largest number of partitions in a parent RDD. For operations like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parallelize&lt;/code&gt; with no parent RDDs, it depends on the cluster manager:&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;
      &lt;p&gt;Local mode: number of cores on the local machine&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;p&gt;Mesos fine grained mode: 8&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;p&gt;Others: total number of cores on all executor nodes or 2, whichever is larger&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ul&gt;

  &lt;p&gt;[meaning]&lt;/p&gt;

  &lt;p&gt;Default number of partitions in RDDs returned by transformations like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;join&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;reduceByKey&lt;/code&gt;, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parallelize&lt;/code&gt; when not set by user.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;yarnì˜ Othersì— í•´ë‹¹í•˜ë¯€ë¡œ, (executor ê°œìˆ˜) * (core ê°œìˆ˜)ë§Œí¼ íŒŒì¼ì„ ì €ì¥í•  ê²ƒì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;how-to-merge&quot;&gt;How to Merge?&lt;/h1&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´ ì´ì²˜ëŸ¼ ë¹„íš¨ìœ¨ì ìœ¼ë¡œ ì €ì¥ëœ Fileì„ í•˜ë‚˜ì˜ Blockìœ¼ë¡œ ì €ì¥í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;hql-case&quot;&gt;HQL case&lt;/h2&gt;

&lt;p&gt;reducer ê°œìˆ˜ë¥¼ ì¡°ì •í•˜ê±°ë‚˜, Tezì—ê²Œ File write ì¡°ê±´ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;-- case1) Reducer ê°œìˆ˜ ì¡°ì •&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mapred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reduce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tasks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;-- case2) hive.merge ì˜µì…˜ ë¶€ì—¬&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapfiles&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- Map ê²°ê³¼ íŒŒì¼ì— ëŒ€í•´ mergeë¥¼ í—ˆìš©&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapredfiles&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- MapReducer ê²°ê³¼ íŒŒì¼ì— ëŒ€í•´ mergeë¥¼ í—ˆìš©&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;per&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;128000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- 128MBì˜ fileë¡œ  merge&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;smallfiles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;avgsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;128000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- 128MB ì´í•˜ì˜ small fileë“¤ì„ merge ëŒ€ìƒìœ¼ë¡œ ì§€ì •&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;spark-case&quot;&gt;Spark case&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;repartition&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;coalesce&lt;/code&gt;  ë¥¼ í†µí•´ output fileì˜ ê°œìˆ˜ë¥¼ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;repartition&lt;/code&gt; ì€ shuffleì„ ìˆ˜í–‰í•˜ì—¬ RDDë¥¼ ì¬ì¡°ì •í•´ì£¼ëŠ”ë° ë¹„í•´,  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;coalesce&lt;/code&gt; ëŠ” shuffleì„ ìˆ˜í–‰í•˜ì§€ ì•Šê³  ì§€ì •ëœ ê°œìˆ˜ì˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;partition&lt;/code&gt;ìœ¼ë¡œ ì¡°ì •í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ëŸ¼  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;partition&lt;/code&gt;ì´ ë¬´ì—‡ì´ëƒ?ë¥¼ ì•Œì•„ì•¼ ì´ ì›ë¦¬ë¥¼ ì´í•´í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;partition&lt;/code&gt; ì´ë€ spark ë‚´ì—ì„œ taskê°€ ì²˜ë¦¬í•˜ëŠ” ë°ì´í„°ì˜ ë‹¨ìœ„ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RDD&lt;/code&gt;(í˜¹ì€ ì´ë“¤ë¡œ ì´ë£¨ì–´ì§„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DataFrame&lt;/code&gt;)ëŠ” ì—¬ëŸ¬ ê°œì˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;partition&lt;/code&gt;ìœ¼ë¡œ ì´ë£¨ì–´ì ¸ìˆê³ , í•˜ë‚˜ì˜ taskê°€ í•˜ë‚˜ì˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;partition&lt;/code&gt;ì„ ë‹´ë‹¹í•˜ì—¬ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ëŸ¬í•œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;partition&lt;/code&gt;ì€ 3ê°œë¡œ ë¶„ë¥˜ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;partition&lt;/th&gt;
      &lt;th&gt;configuration&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Input Partition&lt;/td&gt;
      &lt;td&gt;spark.sql.files.maxPartitionBytes&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Output Partition&lt;/td&gt;
      &lt;td&gt;repartition, coalesce&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Shuffle Partition&lt;/td&gt;
      &lt;td&gt;spark.sql.shuffle.partitions&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;ì´ ì¤‘ì— Output Partitionì„ ì¡°ì •í•˜ì—¬, íŒŒì¼ ê°œìˆ˜ë¥¼ ì ì ˆíˆ ì¡°ì ˆí•´ì¤ë‹ˆë‹¤.&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt; repartition&lt;/code&gt;ì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RDD, DataSet, DataFrame&lt;/code&gt;ê³¼ ê°™ì€ ê°ì²´ ë‚´ë¶€ì˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;partition&lt;/code&gt;ì— ì €ì¥ë  ë°ì´í„°ë¥¼ ì¬ì¡°ì •í•´ì£¼ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. ì´ë•Œ &lt;strong&gt;shuffle&lt;/strong&gt;ì„ í†µí•´, í•´ë‹¹ ê°ì²´ ë‚´ë¶€ì˜ ë°ì´í„°ë“¤ì„ ì¬ë¶„ë°°í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ì— ë¹„í•´  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;coalesce&lt;/code&gt;ëŠ” í˜„ì¬ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;partition&lt;/code&gt; ê°œìˆ˜ë³´ë‹¤ ì ê²Œ ë§Œë“œëŠ” ê²ƒì´ ëª©ì ì´ë¯€ë¡œ, ì¬ì¡°ì •í•˜ì§€ ì•Šê³ (&lt;strong&gt;shuffle í•˜ì§€ ì•Šê³ &lt;/strong&gt;), partitionì— ì¡´ì¬í•˜ëŠ” ë°ì´í„°ë¥¼ ë‹¨ìˆœíˆ ë‹¤ë¥¸ partitionì— ìš±ì—¬ ë„£ëŠ” ì‘ì—…ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ output partitionì„ ì ì ˆíˆ ì‚¬ìš©í•˜ì—¬, output file sizeê°€ 128MB ì´í•˜ê°€ ë˜ì§€ ì•Šë„ë¡ ì¡°ì •í•œ ë’¤, ì €ì¥í•˜ë©´ ë©ë‹ˆë‹¤. ì•„ë˜ ì˜ˆì‹œ ì½”ë“œë¥¼ ë‚¨ê¸°ë©° ê¸€ì„ ë§ˆì¹˜ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SELECT id, grade FROM student&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coalesce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'append'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;saveAsTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test_table&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;[ì°¸ê³ ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://faqreviews.net/question/what-is-hdfs-data-block/&quot;&gt;https://faqreviews.net/question/what-is-hdfs-data-block/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.hdfstutorial.com/hdfs-architecture/block-replication-in-hadoop/&quot;&gt;https://www.hdfstutorial.com/hdfs-architecture/block-replication-in-hadoop/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://forum.huawei.com/enterprise/en/fi-components-relationship-between-spark-and-hdfs/thread/606704-893&quot;&gt;https://forum.huawei.com/enterprise/en/fi-components-relationship-between-spark-and-hdfs/thread/606704-893&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://tech.kakao.com/2021/10/08/spark-shuffle-partition/&quot;&gt;https://tech.kakao.com/2021/10/08/spark-shuffle-partition/&lt;/a&gt;&lt;/p&gt;</content><author><name>GyuhoonK</name></author><category term="hadoop" /><summary type="html">Hiveì—ì„œ ì‘ì€ ìš©ëŸ‰ì˜ íŒŒì¼ë“¤ì„ í•˜ë‚˜ì˜ íŒŒì¼ë¡œ í•©ì¹˜ê¸°</summary></entry><entry><title type="html">Bucket in Hive, Spark</title><link href="http://localhost:4000/bucket-hive-spark" rel="alternate" type="text/html" title="Bucket in Hive, Spark" /><published>2021-10-09T22:30:00+09:00</published><updated>2021-10-09T22:30:00+09:00</updated><id>http://localhost:4000/bucket-hive-spark</id><content type="html" xml:base="http://localhost:4000/bucket-hive-spark">&lt;p&gt;Hiveì™€ Sparkì—ì„œ Bucket ì°¨ì´ì ì— ëŒ€í•˜ì—¬&lt;/p&gt;

&lt;h1 id=&quot;bucketting&quot;&gt;Bucketting&lt;/h1&gt;

&lt;p&gt;Bucketì€ ì¿¼ë¦¬ ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤. íŠ¹íˆ Joinì—ì„œ ì‚¬ìš©ë˜ëŠ” key columnì„ ê¸°ì¤€ìœ¼ë¡œ bucketting í•  ê²½ìš° í° ì„±ëŠ¥ í–¥ìƒì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;Bucketì˜ ê¸°ë³¸ ì•„ì´ë””ì–´ëŠ” ì§€ì •ëœ ì¹¼ëŸ¼ì„ ê¸°ì¤€ìœ¼ë¡œ hash functionì„ í†µí•´ ë§Œë“¤ì–´ì§„ ê°’ì— í•´ë‹¹í•˜ëŠ” bucket fileì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/bucketing-in-hive.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;bucket-in-hive&quot;&gt;Bucket in Hive&lt;/h1&gt;

&lt;p&gt;HiveQLë¡œ Partition, Bucketì´ ì„ ì–¸ëœ í…Œì´ë¸”ì„ ì„ ì–¸í•˜ëŠ” ì¿¼ë¦¬ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;EXTERNAL&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bucketed_tbl&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- EXTERNAL TABLEë¡œ ìƒì„±&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;birthday&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;timestamp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- COLUMNì„ ì„ ì–¸, PARTITIONìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” COLUMNì€ ì œì™¸í•¨&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PARTITIONED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_date&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- PARTITION ê¸°ì¤€ ì„ ì–¸&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;CLUSTERED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- HASH FUNCTIONì— ì‚¬ìš©í•  ê¸°ì¤€ ì„ ì–¸&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;SORTED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;birthday&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- BUCKET ë‚´ì—ì„œ ì •ë ¬ ê¸°ì¤€ ì„ ì–¸&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BUEKCTS&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- BUCKET FILE ê°œìˆ˜ ì„ ì–¸&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;STORED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'parquet'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;LOCATION&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'/user/hive/warehouse/default.db/bucketed_tbl'&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- EXTERNAL TABLEì˜ ì €ì¥ ìœ„ì¹˜&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í•´ë‹¹ í…Œì´ë¸”ì— INSERTëŠ” ì•„ë˜ì™€ ê°™ì€ ì¿¼ë¦¬ë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤(STATIC PARTITION).&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buckted_tbl&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_date&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'20211010'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; 
	&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;birthday&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20211010&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_source&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;INSERT ì´í›„ LOCATIONì—ëŠ” ì•„ë˜ì²˜ëŸ¼ íŒŒì¼ì´ ì €ì¥ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;hdfs dfs &lt;span class=&quot;nt&quot;&gt;-ls&lt;/span&gt; /user/hive/warehouse/default.db/bucketed_tbl
/user/hive/warehouse/default.db/bucketed_tbl/p_date&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;20211010/000000_0
/user/hive/warehouse/default.db/bucketed_tbl/p_date&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;20211010/000000_1
/user/hive/warehouse/default.db/bucketed_tbl/p_date&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;20211010/000000_2
...
/user/hive/warehouse/default.db/bucketed_tbl/p_date&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;20211010/000000_31
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;p_date=20211010&lt;/code&gt; partitionì„ í•œë²ˆ ë” INSERTí•˜ë©´, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_copy1&lt;/code&gt;ì´ ë¶™ì€ bucket fileë“¤ì´ ì €ì¥ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;hdfs dfs &lt;span class=&quot;nt&quot;&gt;-ls&lt;/span&gt; /user/hive/warehouse/default.db/bucketed_tbl
/user/hive/warehouse/default.db/bucketed_tbl/p_date&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;20211010/000000_0
/user/hive/warehouse/default.db/bucketed_tbl/p_date&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;20211010/000000_0_copy_1
/user/hive/warehouse/default.db/bucketed_tbl/p_date&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;20211010/000000_1
/user/hive/warehouse/default.db/bucketed_tbl/p_date&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;20211010/000000_1_copy_1
...
/user/hive/warehouse/default.db/bucketed_tbl/p_date&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;20211010/000000_31
/user/hive/warehouse/default.db/bucketed_tbl/p_date&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;20211010/000000_31_copy_1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;bucket-in-sparkpyspark&quot;&gt;Bucket in Spark(pyspark)&lt;/h1&gt;

&lt;p&gt;Sparkì—ì„œë„ partition, bucket ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤. ìœ„ì—ì„œ ì‹¤í–‰í–ˆë˜ HiveQL ì¿¼ë¦¬ëŠ” ì•„ë˜ pyspark ì½”ë“œì™€ ê°™ì€ í‘œë©´ì ìœ¼ë¡œëŠ” ê°™ì€ ì˜ë¯¸ë¥¼ ì§€ë‹™ë‹ˆë‹¤. ì¦‰ HiveQLì´ë‚˜ ì•„ë˜ pyspark ì½”ë“œëŠ” ëª¨ë‘ 1) External 2) Partition 3) Bucket ì„ ì„ ì–¸í•˜ê³  ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM 20211010_soucre&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'parquet'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;partitionBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'p_date'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bucketBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'name'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sortBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'birthday'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'append'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'path'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'/user/hive/warehouse/default.db/buckted_tbl'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;saveAsTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'default.bucketed_tbl'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;32ê°œì˜ bucket íŒŒì¼ì´ ìƒì„±ë  ê²ƒ ê°™ì§€ë§Œ, ì´ë ‡ê²Œ ì €ì¥í•œ ê²½ìš°ì— ë§¤ìš° ë§ì€ parquet fileì´ ìƒì„±ëœë‹¤ëŠ” ê²ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Bucket in Hiveì—ì„œ ì €ì¥ëœ íŒŒì¼ë“¤ì€ ëª¨ë‘ ì‚­ì œí–ˆë‹¤ê³  ê°€ì •í•˜ê³  ì¡°íšŒ&lt;/span&gt;
hdfs dfs &lt;span class=&quot;nt&quot;&gt;-ls&lt;/span&gt; /user/hive/warehouse/default.db/bucketed_tbl
/user/hive/warehouse/default.db/bucketed_tbl/p_date&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;20211010/part-000000-xxxx-xxxx.parquet
/user/hive/warehouse/default.db/bucketed_tbl/p_date&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;20211010/part-000001-xxxx-xxxx.parquet
...
/user/hive/warehouse/default.db/bucketed_tbl/p_date&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;20211010/part-012415-xxxx-xxxx.parquet
&lt;span class=&quot;c&quot;&gt;# 12416ê°œì˜ bucket file&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì™œ ì´ë ‡ê²Œ ë§ì€ bucketë“¤ì´ ìƒì„±ë˜ëŠ” ê²ƒì¼ê¹Œìš”?&lt;/p&gt;

&lt;p&gt;ì´ëŠ” sparkì—ì„œ buckettingì„ í•  ê²½ìš° ê° MAP ë³„ë¡œ bucekt fileì„ ë§Œë“¤ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/hive-spark-bucket.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ìœ„ ê·¸ë¦¼ì²˜ëŸ¼, Hiveì—ì„œëŠ” Reducer í•˜ë‚˜ê°€ í•˜ë‚˜ì˜ bucketì„ ë§Œë“œëŠ”ë° ë¹„í•´, Sparkì—ì„œëŠ” ê° taskê°€ ìì‹ ì˜ bucketì„ ë§Œë“¤ê³  ì´ë¥¼ í…Œì´ë¸” ê²½ë¡œ(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;path&lt;/code&gt;)ì— ì €ì¥í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê³„ì‚°í•´ë³´ë©´ \(32 * 388 = 12416\)ì…ë‹ˆë‹¤. ì¦‰, 388ê°œì˜ taskê°€ ê°ê° bucket fileì„ ìƒì„±í•˜ì˜€ê¸° ë•Œë¬¸ì— ìœ„ì™€ ê°™ì´ 12416ê°œì˜ bucket fileì´ ì €ì¥ëœ ê²ƒì…ë‹ˆë‹¤. ë”°ë¼ì„œ Sparkë¥¼ í†µí•´ buckettingì„ í•  ë•ŒëŠ” ì´ëŸ¬í•œ ë¶€ë¶„ì— ì£¼ì˜í•´ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;hive-bucket-vs-spark-bucket&quot;&gt;Hive Bucket vs. Spark Bucket&lt;/h1&gt;

&lt;p&gt;ë” í° ë¬¸ì œëŠ” Hive Bucketê³¼ Spark Bucketì´ ì–‘ë¦½í•  ìˆ˜ ì—†ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;sparkë¥¼-í†µí•´-ìƒì„±ëœ-bucketed-tableì€-hiveì—ì„œ-ì¡°íšŒ-ë¶ˆê°€ëŠ¥í•˜ë‹¤&quot;&gt;Sparkë¥¼ í†µí•´ ìƒì„±ëœ Bucketed Tableì€ Hiveì—ì„œ ì¡°íšŒ ë¶ˆê°€ëŠ¥í•˜ë‹¤&lt;/h2&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM 20211010_soucre&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'parquet'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;partitionBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'p_date'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bucketBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'name'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sortBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'birthday'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'append'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'path'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'/user/hive/warehouse/default.db/buckted_tbl'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;saveAsTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'default.bucketed_tbl'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;pysparkë¡œ ìœ„ì™€ ê°™ì´ ì ì¬ì— ì„±ê³µí•˜ë”ë¼ë„, í…Œì´ë¸”ì„ ì¡°íšŒí•˜ëŠ” ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•  ê²½ìš° ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚µë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;hive &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;SELECT * FROM default.bucketed_tbl&quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Error&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;hiveqlë¡œ-ìƒì„±ëœ-bucketed-tableì—ëŠ”-sparkë¥¼-í†µí•´-insertí• -ìˆ˜-ì—†ë‹¤&quot;&gt;HiveQLë¡œ ìƒì„±ëœ Bucketed Tableì—ëŠ” Sparkë¥¼ í†µí•´ INSERTí•  ìˆ˜ ì—†ë‹¤&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;ë¨¼ì € Bucketed Tableì„ ìƒì„±í•˜ëŠ” ì•„ë˜ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.&lt;/p&gt;

    &lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;EXTERNAL&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bucketed_tbl&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- EXTERNAL TABLEë¡œ ìƒì„±&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;birthday&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;timestamp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- COLUMNì„ ì„ ì–¸, PARTITIONìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” COLUMNì€ ì œì™¸í•¨&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PARTITIONED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_date&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- PARTITION ê¸°ì¤€ ì„ ì–¸&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;CLUSTERED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- HASH FUNCTIONì— ì‚¬ìš©í•  ê¸°ì¤€ ì„ ì–¸&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;SORTED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;birthday&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- BUCKET ë‚´ì—ì„œ ì •ë ¬ ê¸°ì¤€ ì„ ì–¸&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BUEKCTS&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- BUCKET FILE ê°œìˆ˜ ì„ ì–¸&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;STORED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'parquet'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;LOCATION&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'/user/hive/warehouse/default.db/bucketed_tbl'&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- EXTERNAL TABLEì˜ ì €ì¥ ìœ„ì¹˜&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;pysparkë¥¼ ì´ìš©í•˜ì—¬ Bucketed Tableì— ë°ì´í„°ë¥¼ append(INSERT)í•©ë‹ˆë‹¤.&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM 20211010_soucre&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'parquet'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;partitionBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'p_date'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bucketBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'name'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sortBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'birthday'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'append'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'path'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'/user/hive/warehouse/default.db/buckted_tbl'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;saveAsTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'default.bucketed_tbl'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;The format of the existing table default.bucketed_tbl is 'HiveFormat'.
It doesn't match the specified format 'ParquetFileFormat'.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;HiveQLë¡œ ìƒì„±í•œ Bucketed Tableì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HiveFormat&lt;/code&gt;ìœ¼ë¡œ ì €ì¥ë˜ì–´ ìˆì–´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ParquetFileFormat&lt;/code&gt; ìœ¼ë¡œ íŒŒì¼ì„ ì ì¬í•  ìˆ˜ ì—†ë‹¤ëŠ” ë©”ì‹œì§€ì…ë‹ˆë‹¤.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ì´ë²ˆì—ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HiveFormat&lt;/code&gt;ìœ¼ë¡œ ì ì¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤.&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM 20211010_soucre&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'hive'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;partitionBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'p_date'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bucketBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'name'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sortBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'birthday'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'append'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'path'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'/user/hive/warehouse/default.db/buckted_tbl'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\
      &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;saveAsTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'default.bucketed_tbl'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;ì´ë²ˆì—ëŠ” ë‹¤ë¥¸ ì—ëŸ¬ ë©”ì‹œì§€ê°€ í™•ì¸ë©ë‹ˆë‹¤.&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Creating buckted Hive Serde table is not supported yet.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Sparkê°€ ì•„ì§ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Bucketed Hive Serde&lt;/code&gt;ë¥¼ ìƒì„±í•˜ëŠ” ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•Šê³  ìˆë‹¤ëŠ” ë‚´ìš©ì…ë‹ˆë‹¤. ì œê°€ í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©í–ˆë˜ spark ë²„ì „ì€ &lt;strong&gt;2.3&lt;/strong&gt;ì…ë‹ˆë‹¤.&lt;/p&gt;

    &lt;p&gt;í˜„ì¬ëŠ” 3.0 ì´ìƒì˜ ë²„ì „ì´ ë¦´ë¦¬ì¦ˆëœ ê²ƒìœ¼ë¡œ ì•Œê³  ìˆëŠ”ë° í˜„ì¬ ì´ ê¸°ëŠ¥ì´ êµ¬í˜„ë˜ì—ˆëŠ”ì§€ëŠ” í™•ì¸í•´ë³´ì•„ì•¼í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;[ì°¸ê³ ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://medium.com/analytics-vidhya/spark-bucketing-is-not-as-simple-as-it-looks-c74f105f4af0&quot;&gt;https://medium.com/analytics-vidhya/spark-bucketing-is-not-as-simple-as-it-looks-c74f105f4af0&lt;/a&gt;&lt;/p&gt;</content><author><name>GyuhoonK</name></author><category term="hadoop" /><summary type="html">Hiveì™€ Sparkì—ì„œ Bucket ì°¨ì´ì ì— ëŒ€í•˜ì—¬</summary></entry><entry><title type="html">Regression in Query</title><link href="http://localhost:4000/regression-in-query" rel="alternate" type="text/html" title="Regression in Query" /><published>2021-10-09T22:30:00+09:00</published><updated>2021-10-09T22:30:00+09:00</updated><id>http://localhost:4000/regression-in-query</id><content type="html" xml:base="http://localhost:4000/regression-in-query"></content><author><name>GyuhoonK</name></author><category term="database" /><summary type="html"></summary></entry><entry><title type="html">OverFlow/UnderFlow Trick in Query</title><link href="http://localhost:4000/overflow-trick" rel="alternate" type="text/html" title="OverFlow/UnderFlow Trick in Query" /><published>2021-10-09T22:30:00+09:00</published><updated>2021-10-09T22:30:00+09:00</updated><id>http://localhost:4000/overflow-trick</id><content type="html" xml:base="http://localhost:4000/overflow-trick"></content><author><name>GyuhoonK</name></author><category term="database" /><summary type="html"></summary></entry><entry><title type="html">Gaussian Kernel</title><link href="http://localhost:4000/gaussian_kernel" rel="alternate" type="text/html" title="Gaussian Kernel" /><published>2021-10-08T22:30:00+09:00</published><updated>2021-10-08T22:30:00+09:00</updated><id>http://localhost:4000/gaussian_kernel</id><content type="html" xml:base="http://localhost:4000/gaussian_kernel">&lt;p&gt;Gaussian Kernel(RBF) ê¸°ë³¸ ê°œë…ì— ëŒ€í•˜ì—¬&lt;/p&gt;

&lt;h1 id=&quot;gaussian-kernel-&quot;&gt;Gaussian Kernel ?&lt;/h1&gt;

&lt;p&gt;Gaussian Kernel, í˜¹ì€ RBF(Radial Basis Function)ë¼ê³ ë„ ë¶ˆë¦¬ìš°ëŠ” ì´ ê¸°ë²•ì€ ì»¤ë„ í•¨ìˆ˜(Kernel Function) ì¤‘ ì €ì°¨ì›ì—ì„œ ê³ ì°¨ì›ìœ¼ë¡œ ë§¤í•‘ì‹œí‚¤ëŠ” ê¸°ë²•(mapping function) ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. íŠ¹íˆ, Gaussian Kernelì€ ë°ì´í„° ì‚¬ì´ì˜ ê±°ë¦¬ë¥¼ ë¬´í•œì°¨ì› ë²¡í„°ê³µê°„ì—ì„œ ì¸¡ì •í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;what-is-kernel-&quot;&gt;What is Kernel ?&lt;/h1&gt;

&lt;p&gt;ë¨¼ì €, ì €ì°¨ì›ì—ì„œ ê³ ì°¨ì›ìœ¼ë¡œ mappingí•˜ê¸° ìœ„í•´ì„œëŠ” ì‚¬ìš©ë˜ëŠ” functionì€ ë§¤í•‘ ì´í›„ ê³ ì°¨ì›ì—ì„œ ë°ì´í„°ì˜ ìœ„ì¹˜ë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì´ ëª©ì ì´ ì•„ë‹™ë‹ˆë‹¤. ê²°ê³¼ì ìœ¼ë¡œ í™•ì¸í•˜ê³  ì‹¶ì€ ê°’ì€ ê³ ì°¨ì›ìœ¼ë¡œ ë§¤í•‘ëœ ì´í›„ ë‘ ë°ì´í„°ì˜ ë‚´ì ê°’(inner product)ì…ë‹ˆë‹¤. ë‚´ì ê°’ì€ ìŠ¤ì¹¼ë¼ê°’ìœ¼ë¡œ ë°˜í™˜ë˜ê³  ì´ë¥¼ í†µí•´ ê³ ì°¨ì›ì— ë§¤í•‘ëœ ë‘ ë²¡í„° ì‚¬ì´ì˜ ê±°ë¦¬ë¥¼ ì¸¡ì •í• ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/inner-product.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ê·¸ëŸ¬ë‚˜ ê³ ì°¨ì› ë§¤í•‘ ì´í›„ ë‚´ì (inner product)ë¥¼ ê³„ì‚°í•˜ì—¬ ë‘ ë²¡í„° ê°„ì˜ ê±°ë¦¬ë¥¼ ì¸¡ì •í•˜ëŠ” ë°©ë²•ì€ ê³„ì‚°ëŸ‰ì´ ë§¤ìš° ë†’ì•„ ë¹„íš¨ìœ¨ì ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ Kernel Trickì´ ì´ìš©ë©ë‹ˆë‹¤. Kernel Trickì€ ê³ ì°¨ì› ë§¤í•‘ê³¼ ë‚´ì  ê³„ì‚°ì„ í•œë²ˆì— ìˆ˜í–‰í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì´ëŸ¬í•œ ë™ì‹œ ì—°ì‚°ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ê²ƒì´ Kernelì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì €ì°¨ì›(m)ì—ì„œ ê³ ì°¨ì›(n)ìœ¼ë¡œ ë§¤í•‘ì‹œì¼œì£¼ëŠ” í•¨ìˆ˜ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•©ë‹ˆë‹¤.&lt;/p&gt;

\[\phi(x) = Ax \\
A : n * m (n&amp;gt;m)\\
x : m * 1\]

&lt;p&gt;ìœ„ í•¨ìˆ˜ëŠ”  mì°¨ì› ë²¡í„°ë¥¼ nì°¨ì›ìœ¼ë¡œ ë§¤í•‘ì‹œì¼œì¤ë‹ˆë‹¤. ì´ ë•Œ, Î¦ëŠ” ì„ í˜•ë³€í™˜(Linear Transformation)ì´ê³ , í–‰ë ¬ ğ´(n x m)ëŠ” ì„ í˜•ë³€í™˜ì— ì‚¬ìš©ë˜ëŠ” í‘œì¤€í–‰ë ¬ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ìœ„ì—ì„œ ë§í–ˆë“¯ì´, ì´ëŸ¬í•œ ë§¤í•‘ì´í›„ ìš°ë¦¬ê°€ ê³„ì‚°í•˜ê³  í•˜ëŠ” ê²ƒì€ ë‘ ë²¡í„°ì˜ ë³€í™˜ ì´í›„ ë‚´ì ê°’ì…ë‹ˆë‹¤. ì•„ë˜ì™€ ê°™ì€ ìˆ˜ì‹ìœ¼ë¡œ ğ¾(Kernel)ì„ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

\[K(x_{i}, x_{j}) = \phi(x_{i})^T \phi(x_{j})
							  =  (Ax_{i})^T (Ax_{j})
							  = x_{i}^TA^TAx_{j}\]

&lt;p&gt;ì´ ë•Œ, ìœ„ ì‹ì—ì„œ ì‚¬ìš©ë˜ëŠ” ë³€ìˆ˜ë“¤ì˜ ì°¨ì›ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

\[x_{i}^T : 1 * m \\
A^T : m * n\\
A : n * m \\
x_{j} : m * 1\]

&lt;p&gt;ê²°ê³¼ì ìœ¼ë¡œ ğ¾ëŠ” ìŠ¤ì¹¼ë¼ê°’ì„ ë°˜í™˜í•˜ê²Œ ë¨ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ğ¾ê°€ ë‘ ë²¡í„°ê°„ì˜ ê±°ë¦¬(ìœ ì‚¬ë„)ë¥¼ ì¸¡ì •í•œë‹¤ëŠ” ì ì—ì„œ ì•„ë˜ ë‘ ê°€ì§€ ì¡°ê±´ì„ ë§Œì¡±í•´ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;

\[i) K(x_{i}, x_{j}) = K(x_{j}, x_{i}) \\
ii) K(x_i, x_i) &amp;gt;= 0\]

&lt;p&gt;ì¦‰, êµí™˜ë²•ì¹™ì´ ì„±ë¦½í•´ì•¼í•˜ê³  ìê¸°ìì‹ ê³¼ì˜ ê±°ë¦¬ë¥¼ ê³„ì‚°í–ˆì„ ë•Œì—ëŠ” ìŒìˆ˜ê°’ì´ ë‚˜ì™€ì„œëŠ” ì•ˆëœë‹¤ëŠ” ì¡°ê±´ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ëŸ¬í•œ ì¡°ê±´ì„ ë§Œì¡±í•˜ê¸° ìœ„í•œ ì¡°ê±´ì„ ê³„ì‚°í•´ë³´ë©´, ğ¾ë¥¼ ì´ë£¨ëŠ” í–‰ë ¬ë“¤ì´&lt;/p&gt;

&lt;p&gt;â€‹	ğ¢) ëŒ€ì¹­í–‰ë ¬(symetric matrix)&lt;/p&gt;

&lt;p&gt;â€‹	ğ¢ğ¢) positive semi-definite matrix&lt;/p&gt;

&lt;p&gt;ë¥¼ ë™ì‹œì— ë§Œì¡±í•´ì•¼í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì´ì™€ ê´€ë ¨ëœ ì¡°ê±´ì€ &lt;strong&gt;Mercerâ€™s Theorem&lt;/strong&gt;ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/mercer.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì´ëŸ¬í•œ ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ì»¤ë„ì—ëŠ” &lt;em&gt;Linear, polynomial, sigmoid&lt;/em&gt; ê·¸ë¦¬ê³  ì§€ê¸ˆ ìš°ë¦¬ê°€ ì‚´í´ë³´ê³  ìˆëŠ” &lt;strong&gt;&lt;em&gt;gaussian&lt;/em&gt;&lt;/strong&gt;ì´ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;gaussian-kernel---infinite-dimensional-vector&quot;&gt;Gaussian Kernel - Infinite-dimensional vector&lt;/h2&gt;

&lt;p&gt;Gaussian Kernelì˜ ê°€ì¥ í° íŠ¹ì§•ì€ ë¬´í•œì°¨ì›ìœ¼ë¡œ ë§¤í•‘ì‹œí‚¨ë‹¤ëŠ” ì ì…ë‹ˆë‹¤. ì•„ë˜ ì‹ì„ í†µí•´ ê°„ë‹¨í•œ ì˜ˆë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê³„ì‚° í¸ì˜ì„±ì„ ìœ„í•´ \(\sigma^2=\dfrac {1}{2}\)ì¸ ê²½ìš°ë¥¼ ì˜ˆì‹œë¡œ ì„ íƒí–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

\[K(x_{i}, x_{j}) = exp(-\dfrac {||x_i - x_j||^2}{2\sigma^2})\\
K(x_{i}, x_{j}) = exp(-{||x_i - x_j||^2}) \text{ (when } \sigma^2=\dfrac {1}{2} \text{)}\\
=exp(-x_i^2)exp(-x_j^2)exp(2x_ix_j)\\
\text {By Taylor's theorem,  } exp(2x_ix_j) = \Sigma_{k=0}^{\infty}(\dfrac {2^kx_i^kx_j^k}{k!})\]

&lt;h2 id=&quot;gaussian-kernel---purpose-of-ğ›”&quot;&gt;Gaussian Kernel - Purpose of ğ›”&lt;/h2&gt;

&lt;p&gt;ğ›”ëŠ” ë¬´í•œì°¨ì›ìœ¼ë¡œ í™•ì¥ëœ ë²¡í„° ì‚¬ì´ì˜ ê±°ë¦¬ ê³„ì‚° ì‹œ ì–¼ë§ˆë‚˜ ë¯¼ê°í•˜ê²Œ ë°˜ì‘í•˜ëŠ”ì§€ ê²°ì •í•˜ëŠ” ë§¤ê°œë³€ìˆ˜ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/gaussian-plot.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ìœ„ ê·¸ë¦¼ì²˜ëŸ¼, \(K(x)\) ì¦‰ Gaussian Kernelì˜ ê³„ì‚° ê²°ê³¼ëŠ” ğ›”ê°€ í´ìˆ˜ë¡ ë²¡í„° ê°„ ê±°ë¦¬ \(x\)ì˜ ì°¨ì´ì— ë‘”ê°í•´ì§‘ë‹ˆë‹¤. ë°˜ëŒ€ë¡œ ğ›”ê°€ ì‘ì•„ì§€ë©´, ë²¡í„° ê°„ ê±°ë¦¬ \(x\)ì— ë¯¼ê°í•˜ê²Œ ë°˜ì‘í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;how-to-use-&quot;&gt;How to Use ?&lt;/h1&gt;

&lt;p&gt;Kernel SVM, Kernel Regressionì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤. ê°ê° ì˜ˆë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;kernel-svm&quot;&gt;Kernel SVM&lt;/h2&gt;

&lt;p&gt;SVM Classificationì€ ë¹„ì„ í˜• ë¶„ë¥˜ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ë‹¤ëŠ” í•œê³„ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•´ ì €ì°¨ì› ê³µê°„ì˜ ë°ì´í„°ë¥¼ ê³ ì°¨ì› ê³µê°„ìœ¼ë¡œ ë§¤í•‘ì‹œì¼œ ì´ˆí‰ë©´ì„ ì°¾ì•„ SVMì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ê³ ì í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/kernel-svm.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;kernel-regression&quot;&gt;Kernel Regression&lt;/h2&gt;

&lt;p&gt;[ì—…ë°ì´íŠ¸ ì˜ˆì •]&lt;/p&gt;

&lt;p&gt;[ì°¸ê³ ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://ratsgo.github.io/machine%20learning/2017/05/30/SVM3/&quot;&gt;https://ratsgo.github.io/machine%20learning/2017/05/30/SVM3/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://tensorflow.blog/%ED%8C%8C%EC%9D%B4%EC%8D%AC-%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D/2-3-7-%EC%BB%A4%EB%84%90-%EC%84%9C%ED%8F%AC%ED%8A%B8-%EB%B2%A1%ED%84%B0-%EB%A8%B8%EC%8B%A0/&quot;&gt;https://tensorflow.blog/%ED%8C%8C%EC%9D%B4%EC%8D%AC-%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D/2-3-7-%EC%BB%A4%EB%84%90-%EC%84%9C%ED%8F%AC%ED%8A%B8-%EB%B2%A1%ED%84%B0-%EB%A8%B8%EC%8B%A0/&lt;/a&gt;&lt;/p&gt;</content><author><name>GyuhoonK</name></author><category term="datascience" /><summary type="html">Gaussian Kernel(RBF) ê¸°ë³¸ ê°œë…ì— ëŒ€í•˜ì—¬</summary></entry><entry><title type="html">CREATE query in Hive</title><link href="http://localhost:4000/hive-query" rel="alternate" type="text/html" title="CREATE query in Hive" /><published>2021-09-16T22:30:00+09:00</published><updated>2021-09-16T22:30:00+09:00</updated><id>http://localhost:4000/hive-query</id><content type="html" xml:base="http://localhost:4000/hive-query">&lt;p&gt;HiveQL - CREATE QUERY êµ¬ì¡°ì— ëŒ€í•˜ì—¬&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;TEMPORARY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;EXTERNAL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IF&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;EXISTS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;table_name&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_name&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data_type&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;column_constraint_specification&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;COMMENT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col_comment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;constraint_specification&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;COMMENT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;table_comment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PARTITIONED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_name&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data_type&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;COMMENT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col_comment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...)]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CLUSTERED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...)&lt;/span&gt; 
  &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SORTED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_name&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;ASC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;DESC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...)]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_buckets&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BUCKETS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SKEWED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...)&lt;/span&gt;                  &lt;span class=&quot;c1&quot;&gt;-- (Note: Available in Hive 0.10.0 and later)]&lt;/span&gt;
     &lt;span class=&quot;k&quot;&gt;ON&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...)&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;STORED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DIRECTORIES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;ROW&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FORMAT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;row_format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; 
   &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;STORED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file_format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
     &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STORED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'storage.handler.class.name'&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;WITH&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SERDEPROPERTIES&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(...)]&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;-- (Note: Available in Hive 0.6.0 and later)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;LOCATION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hdfs_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TBLPROPERTIES&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;property_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;property_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...)]&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;-- (Note: Available in Hive 0.6.0 and later)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;select_statement&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;-- (Note: Available in Hive 0.5.0 and later; not supported for external tables)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í…Œì´ë¸”ì„ ìƒì„±í•˜ëŠ” HiveQLì€ ìœ„ì™€ ê°™ì€ í¬ë§·ì„ ê°€ì§‘ë‹ˆë‹¤. í•œì¤„ í•œì¤„ ì˜ë¯¸ë¥¼ í•´ì„í•´ë³´ê³ ì í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;internal--external--temporary&quot;&gt;INTERNAL / EXTERNAL / TEMPORARY&lt;/h1&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;TEMPORARY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;EXTERNAL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IF&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;EXISTS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.]&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;table_name&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;HIVE í…Œì´ë¸”ì€ í¬ê²Œ 3ê°€ì§€ë¡œ ìƒì„±ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1. MANAGED(Internal)
2. EXTERNAL
3. TEMPORARY
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;EXTERNAL, TEMPORARYëŠ” ìœ„ ì¿¼ë¦¬ì—ì„œ í•˜ë‚˜ë¥¼ ì„ íƒí•´ì„œ ì…ë ¥í•´ì£¼ë©´ ë˜ê³ , MANAGEDëŠ” ì•„ë¬´ê²ƒë„ ì…ë ¥í•˜ì§€ ì•Šê³  ê·¸ëƒ¥ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CREATE TABLE&lt;/code&gt;ë§Œ ì…ë ¥í•˜ëŠ” ê²½ìš°ì…ë‹ˆë‹¤. ì„¸ ê°€ì§€ í…Œì´ë¸” í˜•íƒœëŠ” ì–´ë–»ê²Œ ë‹¤ë¥¸ ê²ƒì¼ê¹Œìš”.&lt;/p&gt;

&lt;p&gt;Managed Tableì€ í…Œì´ë¸”(Hive)ì— ì˜í•´ ë°ì´í„°ê°€ ê´€ë¦¬ë˜ê³ , External Tableì€ ìœ ì €ì— ì˜í•´ ë°ì´í„°ê°€ ê´€ë¦¬ë˜ì–´ì•¼í•œë‹¤ëŠ” ì ì…ë‹ˆë‹¤(Hive assumes that it &lt;em&gt;owns&lt;/em&gt; the data for managed tables. its properties and data layout will and can only be changed via Hive command. For external tables Hive assumes that it does &lt;em&gt;not&lt;/em&gt; manage the data.)&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ, Managed Tableì„ ì‚­ì œí•˜ë©´ í•´ë‹¹ ë°ì´í„°ë„ í•¨ê»˜ ì‚­ì œë˜ì§€ë§Œ, External Tableì€ ì‚­ì œí•´ë„ í…Œì´ë¸”ì— í•´ë‹¹í•˜ëŠ” ë°ì´í„°ê°€ ì‚­ì œë˜ì§€ ì•Šê³  Locationì— ë‚¨ì•„ìˆê²Œë©ë‹ˆë‹¤. ë”°ë¼ì„œ í…Œì´ë¸”/ë°ì´í„°ì˜ ì•ˆì „ì„ ìœ„í•´ì„œëŠ” External Tableì´ ì„ í˜¸ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;h2 id=&quot;managed-tables&quot;&gt;Managed tables&lt;/h2&gt;

  &lt;p&gt;A managed table is stored under the &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.metastore.warehouse.dir&quot;&gt;hive.metastore.warehouse.dir&lt;/a&gt; path property, by default in a folder path similar to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/user/hive/warehouse/databasename.db/tablename/&lt;/code&gt;. The default location can be overridden by the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;location&lt;/code&gt; property during table creation. If a managed table or partition is dropped, the data and metadata associated with that table or partition are deleted. If the PURGE option is not specified, the data is moved to a trash folder for a defined duration.&lt;/p&gt;

  &lt;p&gt;Use managed tables when Hive should manage the lifecycle of the table, or when generating temporary tables.&lt;/p&gt;

  &lt;h2 id=&quot;external-tables&quot;&gt;External tables&lt;/h2&gt;

  &lt;p&gt;An external table describes the metadata / schema on external files. External table files can be accessed and managed by processes outside of Hive. External tables can access data stored in sources such as Azure Storage Volumes (ASV) or remote HDFS locations. If the structure or partitioning of an external table is changed, an &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Managed+vs.+External+Tables#Managedvs.ExternalTables-RecoverPartitions(MSCKREPAIRTABLE)&quot;&gt;MSCK REPAIR TABLE table_name&lt;/a&gt; statement can be used to refresh metadata information.&lt;/p&gt;

  &lt;p&gt;Use external tables when files are already present or in remote locations, and the files should remain even if the table is dropped.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Temporary Tableì€ Viewì— ê°€ê¹ë‹¤ê³  ë³´ì‹œë©´ ë©ë‹ˆë‹¤. í•´ë‹¹ í…Œì´ë¸”ì€ ì„¸ì…˜ì´ ì¢…ë£Œë˜ë©´ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;A table that has been created as a temporary table will only be visible to the current session. Data will be stored in the userâ€™s scratch directory, and deleted at the end of the session.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1 id=&quot;partitioned-by&quot;&gt;PARTITIONED BY&lt;/h1&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PARTITIONED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_name&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data_type&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;COMMENT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col_comment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...)]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í…Œì´ë¸”ì„ íŒŒí‹°ì…˜í•˜ì—¬ ì €ì¥í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, Â íŒŒí‹°ì…˜ì´ ì§€ì •ë˜ì§€ ì•Šì€ ê²½ìš°ì—ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/user/hive/warehouse/databasename.db/tablename/&lt;/code&gt; ë¼ëŠ” í•˜ë‚˜ì˜ ë””ë ‰í† ë¦¬ì— ì €ì¥ë˜ì§€ë§Œ, íŒŒí‹°ì…˜ì„ ì§€ì •í•  ê²½ìš° íŒŒì¼ë“¤ì„ ì§€ì •í•œ ì»¬ëŸ¼ ê¸°ì¤€ì— ë”°ë¼ ë””ë ‰í† ë¦¬ì— ë‚˜ëˆ„ì–´ ì €ì¥í•˜ê²Œë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Partitioned tables can be created using the PARTITIONED BY clause. A table can have one or more partition columns and a separate data directory is created for each distinct value combination in the partition columns.&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;PARTITIONED BYë¥¼ ì ìš©í•˜ëŠ” ê²½ìš°ì™€ ì ìš©í•˜ëŠ” ê²½ìš°ëŠ” ì•„ë˜ì™€ ê°™ì´ ì €ì¥ ê²½ë¡œê°€ ë‹¬ë¼ì§€ê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;-- PARTITIONED BY ì‚¬ìš© ì•ˆí•¨&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;page_view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;viewTime&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;INT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;userid&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;BIGINT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;page_url&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;referrer_url&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;ip&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;COMMENT&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'IP Address of the User'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;COMMENT&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'This is the page view table'&lt;/span&gt;
 &lt;span class=&quot;c1&quot;&gt;-- PARTITIONED BY(country STRING)&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;STORED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SEQUENCEFILE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- ì•„ë˜ ê²½ë¡œì— ëª¨ë“  íŒŒì¼ì´ ì €ì¥ë©ë‹ˆë‹¤.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- /user/hive/warehouse/default.db/page_view/&lt;/span&gt;
 
&lt;span class=&quot;c1&quot;&gt;-- PARTITIONED BY ì‚¬ìš©&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;page_view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;viewTime&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;INT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;userid&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;BIGINT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;page_url&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;referrer_url&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;ip&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;COMMENT&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'IP Address of the User'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;COMMENT&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'This is the page view table'&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;PARTITIONED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;country&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;STORED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SEQUENCEFILE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- ì•„ë˜ ê²½ë¡œì— ë‚˜ëˆ„ì–´ íŒŒì¼ë“¤ì´ ì €ì¥ë©ë‹ˆë‹¤.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- /user/hive/warehouse/default.db/page_view/country='KOR'&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- /user/hive/warehouse/default.db/page_view/country='USA'&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- ...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;íŒŒí‹°ì…˜ì„ ì ìš©í•˜ê²Œ ë˜ë©´ í…Œì´ë¸” ì¡°íšŒì—ì„œ ì„±ëŠ¥ í–¥ìƒì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì•„ë˜ì™€ ê°™ì€ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•œë‹¤ê³  ê°€ì •í•´ë³´ë©´&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-SQL&quot;&gt;SELECT 
	*
FROM
	page_view
WHERE country = 'KOR';
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;íŒŒí‹°ì…˜ì´ ì—†ëŠ” ê²½ìš°ì—ëŠ” í•´ë‹¹ ë””ë ‰í† ë¦¬(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/user/hive/warehouse/default.db/page_view/&lt;/code&gt;) ë‚´ì˜ ëª¨ë“  íŒŒì¼ì„ ì¡°íšŒí•˜ì—¬ì•¼í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ íŒŒí‹°ì…˜ì´ ì ìš©ëœ í…Œì´ë¸”ì˜ ê²½ìš°ì—ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/user/hive/warehouse/default.db/page_view/country='KOR'&lt;/code&gt; ë””ë ‰í† ë¦¬ë§Œì„ ì¡°íšŒí•˜ë©´ WHERE ì¡°ê±´ì„ ë§Œì¡±í•˜ê²Œ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ì ì ˆí•œ ì»¬ëŸ¼ì„ ì„ íƒí•˜ì—¬ íŒŒí‹°ì…˜í•´ì£¼ëŠ” ê²ƒì€ ì¿¼ë¦¬ ì„±ëŠ¥ í–¥ìƒì— ì¤‘ìš”í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;dynamic--static-partition&quot;&gt;DYNAMIC / STATIC PARTITION&lt;/h2&gt;

&lt;p&gt;íŒŒí‹°ì…˜ í…Œì´ë¸”ì— ë°ì´í„° ì…ë ¥ ì‹œ DYNAMIC, STATICì´ë¼ëŠ” ë‘ ê°€ì§€ ë°©ë²•ì´ ì¡´ì¬í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê°„ë‹¨í•˜ê²Œ ì„¤ëª…í•˜ë©´, DYNAMICì€ íŒŒí‹°ì…˜ ì»¬ëŸ¼ë§Œì„ ì§€ì •í•´ì£¼ë©´ í•´ë‹¹ ì»¬ëŸ¼ì˜ valueì— ë”°ë¼ ì•Œì•„ì„œ ë””ë ‰í† ë¦¬ë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•ì´ê³ , STATICì€ í•´ë‹¹ ë°ì´í„°ë¥¼ ì €ì¥í•  ë””ë ‰í† ë¦¬ë¥¼ êµ¬ì²´ì ìœ¼ë¡œ ëª…ì‹œí•´ì£¼ëŠ” ê²ƒì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;-- STATIC PARTITION&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;page_view&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;country&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'JPN'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;temp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- ì•„ë˜ ë””ë ‰í† ë¦¬ê°€ ìƒˆë¡œ ìƒì„±ë©ë‹ˆë‹¤&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- /user/hive/warehouse/default.db/page_view/country='JPN'&lt;/span&gt;
 
&lt;span class=&quot;c1&quot;&gt;-- DYNAMIC PARTITION&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;dynamic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;partition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nonstrict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- dynamic partition í—ˆìš© &lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;page_view&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;country&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;temp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- country valueì— ë”°ë¼ ìë™ìœ¼ë¡œ ë””ë ‰í† ë¦¬ë¥¼ ìƒì„±í•©ë‹ˆë‹¤&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- /user/hive/warehouse/default.db/page_view/country='JPN'&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- /user/hive/warehouse/default.db/page_view/country='CHN'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;clustered-by--sorted-by&quot;&gt;CLUSTERED BY / SORTED BY&lt;/h1&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CLUSTERED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...)&lt;/span&gt; 
&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SORTED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_name&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;ASC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;DESC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...)]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_buckets&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BUCKETS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Bucketingê³¼ ê´€ë ¨ëœ ì˜µì…˜ì…ë‹ˆë‹¤. ì§€ì •ëœ ì¹¼ëŸ¼ì„ í•´ì‰¬ ì²˜ë¦¬í•˜ì—¬ ë¯¸ë¦¬ ì§€ì •ëœ ìˆ˜ì˜ íŒŒì¼(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;num_buckets&lt;/code&gt;)ë¡œ ë‚˜ëˆ„ì–´ ì €ì¥í•©ë‹ˆë‹¤. ì§€ì •ëœ ì¹¼ëŸ¼ì„ ê¸°ì¤€ìœ¼ë¡œ Joinì„ ìˆ˜í–‰í•˜ëŠ” ê²½ìš°ì— ì†ŒíŠ¸ ë¨¸ì§€ ë²„ì¼“(SMB)ìœ¼ë¡œ ì²˜ë¦¬ë˜ì–´ ì„±ëŠ¥ì´ í–¥ìƒë©ë‹ˆë‹¤. íŒŒí‹°ì…˜ì´ íŒŒì¼ì„ ë””ë ‰í† ë¦¬ë¡œ ë‚˜ëˆ„ì–´ ì €ì¥í•˜ëŠ” ë°©ë²•ì´ë¼ë©´, &lt;strong&gt;ë²„ì¼“íŒ…ì€ ë°ì´í„°ë¥¼ íŒŒì¼ë¡œ ë‚˜ëˆ„ì–´ ì €ì¥&lt;/strong&gt;í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SORTED BY&lt;/code&gt; ì— ì˜í•´ ì „ë‹¬ëœ ì»¬ëŸ¼ì„ ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì •ë ¬í•˜ì—¬ ì €ì¥í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;page_view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;viewTime&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;INT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;userid&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;BIGINT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;page_url&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;referrer_url&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;ip&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;COMMENT&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'IP Address of the User'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;COMMENT&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'This is the page view table'&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;PARTITIONED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;country&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;CLUSTERED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;userid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SORTED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;viewTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BUCKETS&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;ROW&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FORMAT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DELIMITED&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;FIELDS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TERMINATED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;01'&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;COLLECTION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ITEMS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TERMINATED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;02'&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;MAP&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KEYS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TERMINATED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;03'&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;STORED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SEQUENCEFILE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- ì•„ë˜ ì²˜ëŸ¼ ê° íŒŒí‹°ì…˜ ë””ë ‰í† ë¦¬ì— num_buckets=32ê°œì˜ íŒŒì¼ë¡œ ë‚˜ë‰˜ì–´, viewTime ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ë˜ì–´ ì €ì¥ë©ë‹ˆë‹¤.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- /user/hive/warehouse/default.db/page_view/country='KOR'/000000_0 ~ 000000_31&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- /user/hive/warehouse/default.db/page_view/country='USA'/000000_0 ~ 000000_31 &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;skewed-by&quot;&gt;SKEWED BY&lt;/h1&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SKEWED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...)&lt;/span&gt;                  &lt;span class=&quot;c1&quot;&gt;-- (Note: Available in Hive 0.10.0 and later)]&lt;/span&gt;
     &lt;span class=&quot;k&quot;&gt;ON&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;STORED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DIRECTORIES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;skewed(í¸í–¥ëœ) ë°ì´í„°ì— ëŒ€ì‘í•  ìˆ˜ ìˆëŠ” ì˜µì…˜ì…ë‹ˆë‹¤. ë§ê·¸ëŒ€ë¡œ, ì–´ë–¤ ì»¬ëŸ¼ì— íŠ¹ì • valueë¥¼ ê°€ì§„ ë°ì´í„°ê°€ ë§ì´ ë“¤ì–´ì˜¬ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;This feature can be used to improve performance for tables where one or more columns have &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Skewed+Join+Optimization&quot;&gt;skewed&lt;/a&gt; values. By specifying the values that appear very often (heavy skew) Hive will split those out into separate files (or directories in case of &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/ListBucketing&quot;&gt;list bucketing&lt;/a&gt;) automatically and take this fact into account during queries so that it can skip or include the whole file (or directory in case of &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/ListBucketing&quot;&gt;list bucketing&lt;/a&gt;) if possible.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ë§Œì•½, col1ì´ 1~100ê¹Œì§€ ê°’ì´ ì¡´ì¬í•˜ì§€ë§Œ, 99%ì˜ ê°’ì´ 1ì´ë¼ë©´ SKEWED BYë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ìœ ë¦¬í•©ë‹ˆë‹¤. ì´ ê²½ìš°ì— PARTITIONED BYë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ 100ê°œì˜ ë””ë ‰í† ë¦¬ë¥¼ ë§Œë“¤ì§€ë§Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;col1=2&lt;/code&gt;~&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;col1=100&lt;/code&gt;ê¹Œì§€ì˜ íŒŒí‹°ì…˜ì€ 1% ë°ì´í„°ë¥¼ ë¶„ë¥˜í•˜ê¸° ìœ„í•´ 99ê°œì˜ ë””ë ‰í† ë¦¬ê°€ ìƒì„±ë©ë‹ˆë‹¤. ë°˜ë©´, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SKEWED BY col1 ON (1)&lt;/code&gt; ì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;col1=1&lt;/code&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;col1!=1&lt;/code&gt; 2ê°œì˜ ë””ë ‰í† ë¦¬ë¡œ ë¶„ë¥˜ë©ë‹ˆë‹¤. ë”°ë¼ì„œ í¸í–¥ëœ ë°ì´í„°ì˜ ê²½ìš° ê´€ë¦¬ê°€ ë” íš¨ìœ¨ì ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;STORED AS DIRECTORIES&lt;/code&gt; ì˜µì…˜ì„ ì§€ì •í•´ì£¼ë©´, ì•„ë˜ì²˜ëŸ¼ ë””ë ‰í† ë¦¬ë¥¼ ë”°ë¡œ ìƒì„±í•˜ì—¬ ì €ì¥í•˜ê³ , ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ íŒŒì¼ë¡œ êµ¬ë¶„í•˜ì—¬ ì €ì¥í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;-- 1ê°œ ì»¬ëŸ¼ì— ëŒ€í•´ SKEWED BY&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;list_bucket_single&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SKEWED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ON&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;STORED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DIRECTORIES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- PARTITION BYì™€ ë¹„ìŠ·í•˜ì§€ë§Œ, ì§€ì •ëœ valueì— ëŒ€í•´ì„œë§Œ ë””ë ‰í† ë¦¬ë¥¼ ìƒì„±í•˜ì—¬ ì €ì¥í•©ë‹ˆë‹¤.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- /user/hive/warehouse/default.db/list_bucket_single/key=1&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- /user/hive/warehouse/default.db/list_bucket_single/key=5&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- /user/hive/warehouse/default.db/list_bucket_single/key=6&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- /user/hive/warehouse/default.db/list_bucket_single/HIVE_DEFAULT_LIST_BUCKETING_DIR_NAME&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;-- 2ê°œ ì»¬ëŸ¼ì— ëŒ€í•´ SKEWED BY&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;list_bucket_multiple&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col2&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col3&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SKEWED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ON&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'s1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'s3'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'s13'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'s78'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;78&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;STORED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DIRECTORIES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- /user/hive/warehouse/default.db/list_bucket_multiple/col1='s1'/col2=1&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- /user/hive/warehouse/default.db/list_bucket_multiple/col1='s3'/col2=3&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- /user/hive/warehouse/default.db/list_bucket_multiple/col1='s13'/col2=13&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- /user/hive/warehouse/default.db/list_bucket_multiple/col1='s78'/col2=78&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- /user/hive/warehouse/default.db/list_bucket_multiple/HIVE_DEFAULT_LIST_BUCKETING_DIR_NAME&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;row-format&quot;&gt;ROW FORMAT&lt;/h1&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;ROW&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FORMAT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;row_format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;êµ¬ë¶„ì(delimeter), ë°ì´í„° í•´ì„ ë°©ë²•(SerDe)ì— ëŒ€í•œ ì •ë³´ë¥¼ ì§€ì •í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;delimeter&quot;&gt;Delimeter&lt;/h2&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;-- data.txt&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-- a,val1^val2^val3,key1:val1^key2:val2&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;col1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;col2&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ARRAY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
   &lt;span class=&quot;n&quot;&gt;col3&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;MAP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;k&quot;&gt;ROW&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FORMAT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DELIMITED&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;FIELDS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TERMINATED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;','&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- Field êµ¬ë¶„ìëŠ” ','&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;COLLECTION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ITEMS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TERMINATED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'^'&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- Collection Items êµ¬ë¶„ìëŠ” '^'&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;MAP&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KEYS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TERMINATED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;':'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- MAP KEYS êµ¬ë¶„ìëŠ” :&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;data.txt&lt;/code&gt; ì— ëŒ€í•˜ì—¬ ìœ„ì™€ ê°™ì€ ì¿¼ë¦¬ë¡œ í…Œì´ë¸”ì„ ìƒì„±í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ í…Œì´ë¸”ì´ ì ì¬ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;{val1, val2, val3}&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;{key1:val1, key2:val2}&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;serde&quot;&gt;SerDe&lt;/h2&gt;

&lt;p&gt;SerDeë€ ë°ì´í„° í•´ì„ ë°©ë²•ì„ ë§í•©ë‹ˆë‹¤. Serializer/Deserialaizerì˜ ì•½ìë¡œ Hiveê°€ ë°ì´í„°ë¥¼ í•´ì„í•˜ëŠ” ë°©ë²•ì„ ì œê³µí•˜ê¸° ìœ„í•œ ìˆ˜ë‹¨ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;íŒŒì¼ ë‚´ ë°ì´í„°(HDFS Files)ì— ì ‘ê·¼í•œ ì´í›„, í•´ë‹¹ ë°ì´í„°ë¥¼ í…Œì´ë¸”ë¡œ ì ì¬í•˜ê¸° ìœ„í•´ Deserialaizerë¥¼ ì´ìš©í•˜ì—¬ Row Formatìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. ë°˜ëŒ€ë¡œ, ì¿¼ë¦¬ ê²°ê³¼ì¸ Rowë“¤ì€ Serializerë¥¼ ì´ìš©í•˜ì—¬ íŒŒì¼ í¬ë§·ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ íŒŒì¼ë¡œ exportí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;HDFS files â€“&amp;gt; InputFileFormat â€“&amp;gt; [key, value] â€“&amp;gt; &lt;strong&gt;Deserializer&lt;/strong&gt; â€“&amp;gt; Row object&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Row object â€“&amp;gt; &lt;strong&gt;Serializer&lt;/strong&gt; â€“&amp;gt; [key, value] â€“&amp;gt; OutputFileFormat â€“&amp;gt; HDFS files&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;img src=&quot;../../assets/built/images/serde.png&quot; alt=&quot;images&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ê¸°ë³¸ ì œê³µë˜ëŠ” SerDeëŠ” ë‹¤ìŒ 7ê°œ ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Avro, ORC, RegEx, Thrift, Parquet, CSV, JsonSerDe&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ìœ„ 7ê°€ì§€ SerDeëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;STORED AS&lt;/code&gt; ì˜µì…˜ì—ì„œ ì§€ì •í•œ íŒŒì¼ ì˜µì…˜ì— ë”°ë¼ ìë™ìœ¼ë¡œ ì„ íƒë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë‹¤ìŒ ì¿¼ë¦¬ë¥¼ í†µí•´ í…Œì´ë¸”ì— ì§€ì •ëœ SerDeë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-SQL&quot;&gt;DESC formatted orc_tbl;
SerDe Library:          org.apache.hadoop.hive.ql.io.orc.OrcSerde    
InputFormat:            org.apache.hadoop.hive.ql.io.orc.OrcInputFormat  
OutputFormat:           org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat   
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ê¸°ë³¸ ì œê³µë˜ëŠ” 7ê°€ì§€ SerDe, ì¦‰ ìœ„ íŒŒì¼ í¬ë§· ì™¸ì— ë‹¤ë¥¸ í˜•ì‹ì˜ íŒŒì¼ í¬ë§·ì˜ ë°ì´í„°ë¥¼ Deseiralizeí•˜ì—¬ í…Œì´ë¸”ì„ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” Custom SerDeë¥¼ ì •ì˜í•´ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ë°ì´í„° í™•ì¸&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;sample.txt
david   23!
cole    3!5
anna    &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;92
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Custom SerDe `SampleSerDe` ì •ì˜&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.hadoop.hive.serde2.SerDeException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.hadoop.io.Text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.hadoop.io.Writable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// LazySimpleSerDeë¥¼ ìƒì†í•˜ì—¬ custom SerDeë¥¼ ì •ì˜&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SampleSerDe&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;LazySimpleSerDe&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;SampleSerDe&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SerDeException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;doDeserialize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Writable&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;field&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SerDeException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;// ëŠë‚Œí‘œëŠ” ì œê±°  &lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;field&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;replaceAll&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;!&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;doDeserialize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Custom SerDeëŠ” ì•„ë˜ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# í´ë˜ìŠ¤ê°€ ë“¤ì–´ ìˆëŠ” jar íŒŒì¼ ì¶”ê°€ &lt;/span&gt;
hive&amp;gt; ADD JAR ./hiveUDF.jar&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# í…Œì´ë¸” ìƒì„± ì‹œì— ì„œë° ì •ë³´ ë° í”„ë¡œí¼í‹° ì •ë³´ ì „ë‹¬ &lt;/span&gt;
hive&amp;gt; CREATE TABLE serde_tbl
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
  col1 STRING
  , col2 STRING
&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 
ROW FORMAT SERDE &lt;span class=&quot;s1&quot;&gt;'com.sec.hive.serde.SampleSerDe'&lt;/span&gt;
WITH SERDEPROPERTIES &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;field.delim&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# ìƒ˜í”Œ ë°ì´í„°ë¥¼ ì…ë ¥ &lt;/span&gt;
hive&amp;gt; LOAD DATA LOCAL INPATH &lt;span class=&quot;s1&quot;&gt;'./sample.txt'&lt;/span&gt; INTO TABLE serde_tbl&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# ë°ì´í„° ì¡°íšŒ &lt;/span&gt;
hive&amp;gt; &lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; from serde_tbl&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
OK
david   23
cole    35
anna    92
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;WITH SERDEPROPERTIES&lt;/code&gt;ëŠ” SerDeì—ì„œ ì§€ì •ë˜ì§€ ì•Šì€ êµ¬ë¶„ìë¥¼ ì¶”ê°€í•´ì¤ë‹ˆë‹¤.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-SQL&quot;&gt;ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
  'serialization.format' = ',',
  'field.delim' = ',',
  'collection.delim' = '|',
  'mapkey.delim' = ':',
  'escape.delim' = '\\'
)
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&quot;stored-as&quot;&gt;STORED AS&lt;/h1&gt;

&lt;pre&gt;&lt;code class=&quot;language-SQL&quot;&gt;[STORED AS file_format]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ê¸°ë³¸ì ìœ¼ë¡œ ì•„ë˜ 7ê°€ì§€ formatì„ ì œê³µí•©ë‹ˆë‹¤. ì•„ë˜ file formatì€ SerDeë„ í•¨ê»˜ ì œê³µë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Storage Format&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;STORED AS TEXTFILE&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Stored as plain text files. TEXTFILE is the default file format, unless the configuration parameter &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.default.fileformat&quot;&gt;hive.default.fileformat&lt;/a&gt; has a different setting.Use the DELIMITED clause to read delimited files.Enable escaping for the delimiter characters by using the â€˜ESCAPED BYâ€™ clause (such as ESCAPED BY â€˜') Escaping is needed if you want to work with data that can contain these delimiter characters.  A custom NULL format can also be specified using the â€˜NULL DEFINED ASâ€™ clause (default is â€˜\Nâ€™). (Hive 4.0) All BINARY columns in the table are assumed to be base64 encoded. To read the data as raw bytes:TBLPROPERTIES (â€œhive.serialization.decode.binary.as.base64â€=â€falseâ€)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;STORED AS SEQUENCEFILE&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Stored as compressed Sequence File.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;STORED AS ORC&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Stored as &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/LanguageManual+ORC#LanguageManualORC-HiveQLSyntax&quot;&gt;ORC file format&lt;/a&gt;. Supports ACID Transactions &amp;amp; Cost-based Optimizer (CBO). Stores column-level metadata.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;STORED AS PARQUET&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Stored as Parquet format for the &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Parquet&quot;&gt;Parquet&lt;/a&gt; columnar storage format in &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Parquet#Parquet-Hive0.13andlater&quot;&gt;Hive 0.13.0 and later&lt;/a&gt;; Use ROW FORMAT SERDE â€¦ STORED AS INPUTFORMAT â€¦ OUTPUTFORMAT syntax â€¦ in &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Parquet#Parquet-Hive0.10-0.12&quot;&gt;Hive 0.10, 0.11, or 0.12&lt;/a&gt;.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;STORED AS AVRO&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Stored as Avro format in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6806&quot;&gt;Hive 0.14.0 and later&lt;/a&gt; (see &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/AvroSerDe&quot;&gt;Avro SerDe&lt;/a&gt;).&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;STORED AS RCFILE&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Stored as &lt;a href=&quot;https://en.wikipedia.org/wiki/RCFile&quot;&gt;Record Columnar File&lt;/a&gt; format.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;STORED AS JSONFILE&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Stored as Json file format in Hive 4.0.0 and later.&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;stored-as-inputformatoutputformat&quot;&gt;STORED &lt;strong&gt;AS&lt;/strong&gt; INPUTFORMAT/OUTPUTFORMAT&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;in the file_format to specify the name of a corresponding InputFormat and OutputFormat class as a string literal.  For example, â€˜org.apache.hadoop.hive.contrib.fileformat.base64.Base64TextInputFormatâ€™.  For LZO compression, the values to use are â€˜INPUTFORMAT â€œcom.hadoop.mapred.DeprecatedLzoTextInputFormatâ€ OUTPUTFORMAT â€œ&lt;a href=&quot;http://org.apache.hadoop.hive.ql.io/&quot;&gt;org.apache.hadoop.hive.ql.io&lt;/a&gt;.HiveIgnoreKeyTextOutputFormatâ€â€™  (see &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/LanguageManual+LZO&quot;&gt;LZO Compression&lt;/a&gt;).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;INPUTFORMATê³¼ OUTPUTFORMATì„ ë”°ë¡œ ì§€ì •í•´ì¤„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;-- INPUTFORMAT, OUTPUTFORMATì„ ë”°ë¡œ ì§€ì •í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥ &lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;col1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STRING&lt;/span&gt; 
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STORED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;INPUTFORMAT&lt;/span&gt;  &lt;span class=&quot;nv&quot;&gt;&quot;com.hadoop.mapred.DeprecatedLzoTextInputFormat&quot;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;OUTPUTFORMAT&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;&quot;org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;stored-by&quot;&gt;STORED BY&lt;/h2&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;STORED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'storage.handler.class.name'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;Stored by a non-native table format. To create or link to a non-native table, for example a table backed by &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration&quot;&gt;HBase&lt;/a&gt; or &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Druid+Integration&quot;&gt;Druid&lt;/a&gt; or &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/AccumuloIntegration&quot;&gt;Accumulo&lt;/a&gt;. See &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/StorageHandlers&quot;&gt;StorageHandlers&lt;/a&gt; for more information on this option.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;non-native table&lt;/strong&gt; ì€ Hiveì— ì˜í•´ ì €ì¥ë˜ì§€ ì•Šì€ ë°ì´í„° ì†ŒìŠ¤ë¡œë¶€í„° ìƒì„±ëœ í…Œì´ë¸”ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ì´ë“¤ì€ ê°ê°ì˜ data sourceì— ì•Œë§ì€ handlerë¥¼ ì ìš©í•´ì•¼í•©ë‹ˆë‹¤ (Tables that use a storage handler, such as the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DruidStorageHandler&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HBaseStorageHandler&lt;/code&gt;).&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;EXTERNAL&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hiveTableName&lt;/span&gt; 
	&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col2&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bigint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col3&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;STORED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'org.apache.hadoop.hive.dynamodb.DynamoDBStorageHandler'&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;TBLPROPERTIES&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;&quot;dynamodb.table.name&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;&quot;dynamodbtable1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
               &lt;span class=&quot;nv&quot;&gt;&quot;dynamodb.column.mapping&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;&quot;col1:name,col2:year,col3:holidays&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ ì¿¼ë¦¬ëŠ” DynamoDBì— ì €ì¥ëœ ë°ì´í„°ë¥¼ ì°¸ì¡°í•˜ëŠ” Hive í…Œì´ë¸”ì„ ë§Œë“­ë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;location&quot;&gt;LOCATION&lt;/h1&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;LOCATION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hdfs_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;LOCATION now refers to the default directory for external tables and MANAGEDLOCATION refers to the default directory for managed tables. Its recommended that MANAGEDLOCATION be within &lt;strong&gt;metastore.warehouse.dir&lt;/strong&gt; so all managed tables have a common root where common governance policies. It can be used with metastore.warehouse.tenant.colocation to have it point to a directory outside the warehouse root directory to have a tenant based common root where quotas and other policies can be set.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Managed Tableì€ default deirctory(MANAGEDLOCATION)ì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ë¯€ë¡œ LOCATIONì„ ëª…ì‹œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í•´ë‹¹ ì˜µì…˜ì€ EXTERNAL Tableì—ì„œ ë°ì´í„°ì˜ ìœ„ì¹˜ë¥¼ ì „ë‹¬í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The EXTERNAL keyword lets you create a table and provide a LOCATION so that Hive does not use a default location for this table. This comes in handy if you already have data generated.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;External Tableì€ DROP ì‹œ, í…Œì´ë¸”ì€ ì‚­ì œë˜ì§€ë§Œ LOCATIONì˜ ë°ì´í„°ë“¤ì€ ì‚­ì œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í…Œì´ë¸” ì‚­ì œì™€ ë™ì‹œì— ë°ì´í„°ë„ ì‚­ì œí•˜ê¸° ìœ„í•´ì„œëŠ” ì•„ë˜ ë”°ë¡œ ì˜µì…˜ì„ ì§€ì •í•´ì£¼ì–´ì•¼í•©ë‹ˆë‹¤(setting table property &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;external.table.purge=true&lt;/code&gt;, will also delete the data).&lt;/p&gt;

&lt;h1 id=&quot;tblproperties&quot;&gt;TBLPROPERTIES&lt;/h1&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TBLPROPERTIES&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;property_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;property_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...)]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í…Œì´ë¸” ì†ì„±(ì˜µì…˜)ì„ ì§€ì •í•´ì¤ë‹ˆë‹¤. ì•„ë˜ì™€ ê°™ì€ ì˜µì…˜ë“¤ì´ ì¡´ì¬í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The TBLPROPERTIES clause allows you to tag the table definition with your own metadata key/value pairs. Some predefined table properties also exist, such as last_modified_user and last_modified_time which are automatically added and managed by Hive. Other predefined table properties include:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;ul&gt;
    &lt;li&gt;TBLPROPERTIES (â€œcommentâ€=â€&lt;em&gt;table_comment&lt;/em&gt;â€)&lt;/li&gt;
    &lt;li&gt;TBLPROPERTIES (â€œhbase.table.nameâ€=â€&lt;em&gt;table_name&lt;/em&gt;â€) â€“ see &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-Usage&quot;&gt;HBase Integration&lt;/a&gt;.&lt;/li&gt;
    &lt;li&gt;TBLPROPERTIES (â€œimmutableâ€=â€trueâ€) or (â€œimmutableâ€=â€falseâ€) in release 0.13.0+ (&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6406&quot;&gt;HIVE-6406&lt;/a&gt;) â€“ see &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DML#LanguageManualDML-InsertingdataintoHiveTablesfromqueries&quot;&gt;Inserting Data into Hive Tables from Queries&lt;/a&gt;.&lt;/li&gt;
    &lt;li&gt;TBLPROPERTIES (â€œorc.compressâ€=â€ZLIBâ€) or (â€œorc.compressâ€=â€SNAPPYâ€) or (â€œorc.compressâ€=â€NONEâ€) and other ORC properties â€“ see &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/LanguageManual+ORC#LanguageManualORC-HiveQLSyntax&quot;&gt;ORC Files&lt;/a&gt;.&lt;/li&gt;
    &lt;li&gt;TBLPROPERTIES (â€œtransactionalâ€=â€trueâ€) or (â€œtransactionalâ€=â€falseâ€) in release 0.14.0+, the default is â€œfalseâ€ â€“ see &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions#HiveTransactions-TableProperties&quot;&gt;Hive Transactions&lt;/a&gt;.&lt;/li&gt;
    &lt;li&gt;TBLPROPERTIES (â€œNO_AUTO_COMPACTIONâ€=â€trueâ€) or (â€œNO_AUTO_COMPACTIONâ€=â€falseâ€), the default is â€œfalseâ€ â€“ see &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions#HiveTransactions-TableProperties&quot;&gt;Hive Transactions&lt;/a&gt;.&lt;/li&gt;
    &lt;li&gt;TBLPROPERTIES (â€œcompactor.mapreduce.map.memory.mbâ€=â€&lt;em&gt;mapper_memoryâ€&lt;/em&gt;) â€“ see &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions#HiveTransactions-TableProperties&quot;&gt;Hive Transactions&lt;/a&gt;.&lt;/li&gt;
    &lt;li&gt;TBLPROPERTIES (â€œcompactorthreshold.hive.compactor.delta.num.thresholdâ€=â€&lt;em&gt;threshold_num&lt;/em&gt;â€) â€“ see &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions#HiveTransactions-TableProperties&quot;&gt;Hive Transactions&lt;/a&gt;.&lt;/li&gt;
    &lt;li&gt;TBLPROPERTIES (â€œcompactorthreshold.hive.compactor.delta.pct.thresholdâ€=â€&lt;em&gt;threshold_pct&lt;/em&gt;â€) â€“ see &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions#HiveTransactions-TableProperties&quot;&gt;Hive Transactions&lt;/a&gt;.&lt;/li&gt;
    &lt;li&gt;TBLPROPERTIES (â€œauto.purgeâ€=â€trueâ€) or (â€œauto.purgeâ€=â€falseâ€) in release 1.2.0+ (&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-9118&quot;&gt;HIVE-9118&lt;/a&gt;) â€“ see &lt;a href=&quot;https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=82706445#LanguageManualDDL-DropTable&quot;&gt;Drop Table&lt;/a&gt;, &lt;a href=&quot;https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=82706445#LanguageManualDDL-DropPartitions&quot;&gt;Drop Partitions&lt;/a&gt;, &lt;a href=&quot;https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=82706445#LanguageManualDDL-TruncateTable&quot;&gt;Truncate Table&lt;/a&gt;, and &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DML#LanguageManualDML-InsertOverwrite&quot;&gt;Insert Overwrite&lt;/a&gt;.&lt;/li&gt;
    &lt;li&gt;TBLPROPERTIES (â€œEXTERNALâ€=â€TRUEâ€) in release 0.6.0+ (&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1329&quot;&gt;HIVE-1329&lt;/a&gt;) â€“ Change a managed table to an external table and vice versa for â€œFALSEâ€.
      &lt;ul&gt;
        &lt;li&gt;As of Hive 2.4.0 (&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-16324&quot;&gt;HIVE-16324&lt;/a&gt;) the value of the property â€˜EXTERNALâ€™ is parsed as a boolean (case insensitive true or false) instead of a case sensitive string comparison.&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
    &lt;li&gt;TBLPROPERTIES (â€œexternal.table.purgeâ€=â€trueâ€) in release 4.0.0+ (&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-19981&quot;&gt;HIVE-19981&lt;/a&gt;) when set on external table would delete the data as well.&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;h1 id=&quot;as-select&quot;&gt;AS SELECT&lt;/h1&gt;

&lt;pre&gt;&lt;code class=&quot;language-SQL&quot;&gt;[AS select_statement]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;CTAS(&lt;strong&gt;C&lt;/strong&gt;REATE-&lt;strong&gt;T&lt;/strong&gt;ABLE-&lt;strong&gt;A&lt;/strong&gt;S-&lt;strong&gt;S&lt;/strong&gt;ELECT) êµ¬ë¬¸ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤. í•´ë‹¹ êµ¬ë¬¸ìœ¼ë¡œ ìƒì„±í•˜ê³ ìí•˜ëŠ” í…Œì´ë¸”ì€ CTAS ì¿¼ë¦¬ê°€ ì™„ë£Œë˜ê¸° ì „ê¹Œì§€ëŠ” ë‹¤ë¥¸ ìœ ì €ì— ì˜í•´ ì¡°íšŒê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Tables can also be created and populated by the results of a query in one create-table-as-select (CTAS) statement. The table created by CTAS is atomic, meaning that &lt;strong&gt;the table is not seen by other users until all the query results are populated&lt;/strong&gt;. So other users will either see the table with the complete results of the query or will not see the table at all.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ì•„ë˜ì™€ ê°™ì€ í˜•ì‹ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_key_value_store&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;ROW&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FORMAT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SERDE&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;&quot;org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe&quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;STORED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RCFile&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;AS&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key_value_pair&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key_value_store&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SORT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key_value_pair&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;CTAS êµ¬ë¬¸ì€ ëª‡ ê°€ì§€ íŠ¹ì§•ì„ ê°–ìŠµë‹ˆë‹¤. í•˜ë‚˜ì”© ì‚´í´ë³´ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;CTASêµ¬ë¬¸ ì‚¬ìš© ì‹œ, External Tableì„ ìƒì„±í•  ìˆ˜ ì—†ê³ , Bucketë„ ì§€ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;blockquote&gt;
  &lt;p&gt;CTAS has these restrictions:&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;The target table cannot be an external table.&lt;/li&gt;
    &lt;li&gt;The target table cannot be a list bucketing table.&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;ol&gt;
  &lt;li&gt;Source Table(SELECT êµ¬ë¬¸ ì•ˆì˜ í…Œì´ë¸”)ê³¼ ë³„ê°œì˜ SerDeì™€ File Formatì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¦‰, ìœ„ ì¿¼ë¦¬ì—ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;new_key_value_store&lt;/code&gt;ì˜ File Formatê³¼ SerDeëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;key_value_store&lt;/code&gt;ì™€ ë™ì¼í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;blockquote&gt;
  &lt;p&gt;the new target table is created using a specific SerDe and a storage format independent of the source tables in the SELECT statement.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ol&gt;
  &lt;li&gt;CTAS êµ¬ë¬¸ì€ CTE(Common Table Expression)ê³¼ í•¨ê»˜ ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AS&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;WITH&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;src&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'4'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- CTE&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Â ì—¬ê¸°ê¹Œì§€, Hive CREATE TABLEì—ì„œ ì‚¬ìš©ë˜ëŠ” ì¿¼ë¦¬ì— ëŒ€í•´ì„œ ëª¨ë‘ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. ê°€ì¥ ì¤‘ìš”í•œ ë¶€ë¶„ì€ Partition, BucketÂ , Skew ë¶€ë¶„ì´ ì•„ë‹Œê°€ ì‹¶ìŠµë‹ˆë‹¤. ì²˜ìŒ HiveQLë¥¼ ì ‘í•˜ì‹œëŠ” ë¶„ë“¤ê»˜ ì´ í¬ìŠ¤íŒ…ì´ ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;[ì°¸ì¡°]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-CreateTableCreate/Drop/TruncateTable&quot;&gt;https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDLCreateTableCreate/Drop/TruncateTable&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://wikidocs.net/book/2203&quot;&gt;https://wikidocs.net/book/2203&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.aws.amazon.com/ko_kr/emr/latest/ReleaseGuide/EMR_Hive_Commands.html&quot;&gt;https://docs.aws.amazon.com/ko_kr/emr/latest/ReleaseGuide/EMR_Hive_Commands.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.educative.io/collection/page/6089575797620736/6248215343005696/6394690049933312&quot;&gt;https://www.educative.io/collection/page/6089575797620736/6248215343005696/6394690049933312&lt;/a&gt;&lt;/p&gt;</content><author><name>GyuhoonK</name></author><category term="hadoop" /><summary type="html">HiveQL - CREATE QUERY êµ¬ì¡°ì— ëŒ€í•˜ì—¬</summary></entry><entry><title type="html">Connection to DataBase in Python, R</title><link href="http://localhost:4000/connect-to-database" rel="alternate" type="text/html" title="Connection to DataBase in Python, R" /><published>2021-09-06T22:30:00+09:00</published><updated>2021-09-06T22:30:00+09:00</updated><id>http://localhost:4000/connect-to-database</id><content type="html" xml:base="http://localhost:4000/connect-to-database">&lt;p&gt;python, Rì—ì„œ Database Serverì™€ ì—°ê²°í•˜ê¸°&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/odbc-architecture.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ìœ„ ê·¸ë¦¼ì²˜ëŸ¼ Database Serverì™€ ì—°ê²°í•˜ê¸° ìœ„í•´ì„œëŠ” 1. Driver Manager í˜¹ì€ 2. DSN(Data Source Name)ì„ ì•Œì•„ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;Driver Managerì™€ DSNì´ ë¬´ì—‡ì¸ì§€ í•˜ë‚˜ì”© ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;driver-manager--driver&quot;&gt;Driver Manager &amp;amp; Driver&lt;/h1&gt;

&lt;p&gt;oracleì—ì„œëŠ”  Driver Managerë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The Driver Manager is a library that manages communication between application and driver or drivers. It performs the following tasks:&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;
      &lt;p&gt;Resolves Data Source Names (DSN). The DSN is a configuration string that identifies a given database driver, database, database host and optionally authentication information that enables an ODBC application to connect to a database using a standardized reference.&lt;/p&gt;

      &lt;p&gt;Because the database connectivity information is identified by the DSN, any ODBC-compliant application can connect to the data source using the same DSN reference. This eliminates the need to separately configure each application that needs access to a given database; instead you instruct the application to use a pre-configured DSN.&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;p&gt;Loading and unloading of the driver required to access a specific database as defined within the DSN. For example, if you have configured a DSN that connects to a MySQL database then the driver manager will load the Connector/ODBC driver to enable the ODBC API to communicate with the MySQL host.&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;p&gt;Processes ODBC function calls or passes them to the driver for processing.&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;ë‚˜ì•„ê°€  ODBC Driver Managerì— ëŒ€í•œ ì •ì˜ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;An ODBC Driver Manager is a library that manages communication between the ODBC-aware application and any drivers. Its main functionality includes:&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;Resolving Data Source Names (DSN).&lt;/li&gt;
    &lt;li&gt;Driver loading and unloading.&lt;/li&gt;
    &lt;li&gt;Processing ODBC function calls or passing them to the driver.&lt;/li&gt;
  &lt;/ul&gt;

  &lt;p&gt;Most ODBC Driver Manager implementations also include an administration application that makes the configuration of DSN and drivers easier. Examples and information on ODBC Driver Managers for different operating systems are listed below:&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;Windows: Microsoft Windows ODBC Driver Manager (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;odbc32.dll&lt;/code&gt;). It is included in the Windows operating system. See http://support.microsoft.com/kb/110093 for more information.&lt;/li&gt;
    &lt;li&gt;macOS: ODBC Administrator is a GUI application for macOS. It provides a simplified configuration mechanism for the iODBC Driver Manager. You can configure DSN and driver information either through ODBC Administrator or through the iODBC configuration files. This also means that you can test ODBC Administrator configurations using the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;iodbctest&lt;/code&gt; command. See http://support.apple.com/kb/DL895 for more information.&lt;/li&gt;
    &lt;li&gt;Unix:
      &lt;ul&gt;
        &lt;li&gt;unix ODBC Driver Manager for Unix (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;libodbc.so&lt;/code&gt;). See &lt;a href=&quot;http://www.unixodbc.org/&quot;&gt;http://www.unixodbc.org&lt;/a&gt;, for more information.&lt;/li&gt;
        &lt;li&gt;iODBC Driver Manager for Unix (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;libiodbc.so&lt;/code&gt;). See &lt;a href=&quot;http://www.iodbc.org/&quot;&gt;http://www.iodbc.org&lt;/a&gt;, for more information.&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;ì¡°ê¸ˆ ê¸´ ì„¤ëª…ì´ì§€ë§Œ í•µì‹¬ë§Œ ìš”ì•½í•˜ìë©´, Driver ManagerëŠ” í¬ê²Œ ì„¸ ê°€ì§€ ì—­í• ì„ í•˜ê³  ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;DSNì„ ë‹¤ë£¬ë‹¤(resolve)&lt;/li&gt;
  &lt;li&gt;íŠ¹ì • DBì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ í•„ìš”í•œ Driverë¥¼ ë¡œë”©/ì–¸ë¡œë”©í•œë‹¤&lt;/li&gt;
  &lt;li&gt;ODBC í•¨ìˆ˜ë¥¼ ì²˜ë¦¬í•˜ê±°ë‚˜, Driverì—ê²Œ ì „ë‹¬í•œë‹¤&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ê·¸ë¦¬ê³  ìš´ì˜ì²´ì œë³„ë¡œ ì„œë¡œ ë‹¤ë¥¸ Driver Managerë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤(Windows - MicroSoft Windows ODBC Driver Manager, macOS - ODBC Administrator/iODBC Driver Manager, Unix - UnixODBC Driver Manager for Unix/iODBC Driver Manager for Unix).&lt;/p&gt;

&lt;p&gt;DSNì€ ë‚˜ì¤‘ì— ì•Œì•„ë³´ê¸°ë¡œ í•˜ê³ , ì—¬ê¸°ì„œ ë§í•˜ëŠ” Driverë€ ë¬´ì—‡ì¼ê¹Œìš”?&lt;/p&gt;

&lt;p&gt;IBMì—ì„œ ODBC Driverì— ëŒ€í•œ ì •ì˜ë¥¼ ì°¾ì•„ë³´ì•˜ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ODBC drivers&lt;/p&gt;

  &lt;p&gt;An ODBC driver uses a layer of code that translates the ODBC standard API calls that the application issues into vendor-specific functions. IBM Netezza supplies an ODBC driver for many supported platforms (32 bit and 64 bit) and for many different versions of the Netezza database.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ODBC driverëŠ” Applicationì—ì„œ ìš”ì²­í•œ  APIë¥¼ ì§€ì •ëœ í•¨ìˆ˜ë¡œ ì¹˜í™˜í•´ì£¼ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ìœ„ ë‚´ìš©ì„ ë„ì‹í™”í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/odbcmodel.gif&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì¦‰, Driver ManagerëŠ” ì ì ˆí•œ Driverë¥¼ ë¡œë”©í•˜ê³ , ë¡œë”©ëœ DriverëŠ” Applicationì—ì„œ ìš”êµ¬í•œ APIë¥¼ ì ì ˆí•œ í•¨ìˆ˜ë¡œ ì¹˜í™˜í•˜ì—¬ DBê°€ ì‘ì—…ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œë” ì „ë‹¬í•©ë‹ˆë‹¤. ì°¸ê³ ë¡œ, Driver Manager, ODBC Driverê¹Œì§€ Clientê°€ ì„¤ì¹˜í•˜ê³  ì…‹íŒ…ì„ ë§ˆì¹œ ìƒíƒœì—¬ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/client-server.jpeg&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;dsndata-source-name&quot;&gt;DSN(Data Source Name)&lt;/h1&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´ DSNì´ë€ ë¬´ì—‡ì¼ê¹Œìš”. ì´ì „ í•­ëª©ì—ì„œ DSNì€ Driver Managerê°€ ë‹¤ë£¨ê³  ìˆë‹¤ê³ ë§Œ ì„¤ëª…í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;a data source name (DSN, sometimes known as a database source name, though â€œdata sourcesâ€ can comprise other repositories apart from databases) is a string that has an associated data structure used to describe a connection to a data source. Most commonly used in connection with ODBC, DSNs also exist for JDBC and for other data access mechanisms. The term often overlaps with â€œconnection stringâ€. Most systems do not make a distinction between DSNs or connection strings and the term can often be used interchangeably.&lt;/p&gt;

  &lt;p&gt;DSN attributes may include, but are not limited to:&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;the name of the data source&lt;/li&gt;
    &lt;li&gt;the location of the data source&lt;/li&gt;
    &lt;li&gt;the name of a database driver which can access the data source&lt;/li&gt;
    &lt;li&gt;a user ID for data access (if required)&lt;/li&gt;
    &lt;li&gt;a user password for data access (if required)&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;DSNì´ë€  data source(database)ì™€ì˜ ì—°ê²°ì„ ì •ì˜í•˜ëŠ” ë¬¸ìì—´ì´ë¼ëŠ” ì„¤ëª…ì…ë‹ˆë‹¤. ì¦‰, ì´ë¥¼ í†µí•´ Driver ManagerëŠ” Driver, UID/PWD, read-onlyì™€ ê°™ì€ ì—°ê²°ì— í•„ìš”í•œ ì •ë³´ë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ, DSNì€ DB ì—°ê²°ì— í•„ìš”í•œ ì •ë³´ë“¤ì´ ì •ì˜ë˜ì–´ìˆëŠ” ìë£Œêµ¬ì¡°ë¡œì„œ connection stringê³¼ëŠ” êµ¬ë¶„ë˜ì–´ì•¼í•œë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;DSNì˜ êµ¬ë¶„ì„ ë³´ë©´, connection stringê³¼ êµ¬ë¶„ë¨ì„ í™•ì‹¤íˆ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. DSNì€ ì„¸ ê°€ì§€ë¡œ ë¶„ë¥˜ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;ul&gt;
    &lt;li&gt;
      &lt;p&gt;&lt;strong&gt;File DSNs&lt;/strong&gt; â€“ stored in the filesystem with one DSN per file&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;System DSNs&lt;/strong&gt; â€“ accessible by any and all processes and users of the system, stored in a centralized location (e.g., /etc/odbc.ini, /etc/odbc_file_dsns/&lt;filename&gt;)&lt;/filename&gt;&lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;User DSNs&lt;/strong&gt; â€“ accessible only by the user who created the DSN, stored in a user-specific location (e.g., ~/.odbc.ini, ~/odbc_file_dsns/&lt;filename&gt;)&lt;/filename&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;User DSNì€ ë¡œì»¬ì—ì„œ ì‚¬ìš©ë˜ê³ , System DSNì€ í•˜ë‚˜ì˜ ì„œë²„ì—ì„œ ì‚¬ìš©ë˜ë©°, File DSNì€ íŒŒì¼ë¡œ ì €ì¥ëœ DSNì´ë¼ê³  í•´ì„í•´ë„ ë¬´ë°©í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;System DSN, User DSNì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ini&lt;/code&gt; í™•ì¥ìë¥¼ ì‚¬ìš©í•˜ì—¬ ê´€ë¦¬ë©ë‹ˆë‹¤.  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ini&lt;/code&gt;ëŠ” ì„¤ì • íŒŒì¼ì— ì‚¬ìš©ë˜ëŠ” í™•ì¥ìì…ë‹ˆë‹¤. File DSNì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DSN&lt;/code&gt; í™•ì¥ìë¡œ ì €ì¥ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì•„ë˜ëŠ” unix, maxOSì—ì„œ DSN(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;odbc.ini&lt;/code&gt;)ì˜ ì˜ˆì‹œì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# [DSN name]
[MSSQLTest]
Driver = ODBC Driver 17 for SQL Server
# Server = [protocol:]server[,port]  
Server = tcp:localhost,1433

# Note:  
# Port is not a valid keyword in the odbc.ini file  
# for the Microsoft ODBC driver on Linux or macOS
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê° ìš´ì˜ì²´ì œì— ë§ëŠ” Driver Managerë¥¼ ì´ìš©í•˜ì—¬ ìœ„ì™€ ê°™ì€ DSNì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•´ë‹¹ ë‚´ìš©ì€ ë§í¬ë¡œ ëŒ€ì²´í•˜ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;[Windows]&lt;a href=&quot;https://docs.informatica.com/data-integration/powerexchange-adapters-for-informatica/10-4-1/powerexchange-for-amazon-redshift-user-guide/pushdown-optimization/configuring-a-system-dsn/configuring-a-system-dsn-on-windows.html&quot;&gt;https://docs.informatica.com/data-integration/powerexchange-adapters-for-informatica/10-4-1/powerexchange-for-amazon-redshift-user-guide/pushdown-optimization/configuring-a-system-dsn/configuring-a-system-dsn-on-windows.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;[Linux]&lt;a href=&quot;https://docs.informatica.com/data-integration/powerexchange-adapters-for-informatica/10-4-1/powerexchange-for-amazon-redshift-user-guide/pushdown-optimization/configuring-a-system-dsn/configuring-a-system-dsn-on-linux.html&quot;&gt;https://docs.informatica.com/data-integration/powerexchange-adapters-for-informatica/10-4-1/powerexchange-for-amazon-redshift-user-guide/pushdown-optimization/configuring-a-system-dsn/configuring-a-system-dsn-on-linux.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;[macOS]&lt;a href=&quot;https://docs.oracle.com/cd/E17952_01/connector-odbc-en/connector-odbc-configuration-dsn-macos.html&quot;&gt;https://docs.oracle.com/cd/E17952_01/connector-odbc-en/connector-odbc-configuration-dsn-macos.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Linux, maxOSì˜ ê²½ìš°ì— &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;odbc.ini&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;odbcinst.ini&lt;/code&gt; ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ì´ ë‘˜ì€ ì„œë¡œ ë‹¤ë¥¸ ì—­í• ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;blockquote&gt;
      &lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://www.ibm.com/docs/en/SSGU8G_14.1.0/com.ibm.odbc.doc/ids_odbc_059.htm&quot;&gt;The odbcinst.ini file&lt;/a&gt;&lt;/strong&gt;
The odbcinst.ini file has entries for all the installed drivers on your computer.&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Section&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Description&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Status&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ODBC drivers&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;List of names of all the installed ODBC drivers&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Optional&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ODBC driver specifications&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;List of driver attributes and values&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Optional&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;blockquote&gt;
      &lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://www.ibm.com/docs/en/SSGU8G_14.1.0/com.ibm.odbc.doc/ids_odbc_062.htm&quot;&gt;The odbc.ini file&lt;/a&gt;&lt;/strong&gt;
The odbc.ini file is a sample data-source configuration information file.&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Section&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Description&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Statu&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ODBC Data Sources&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;This section lists the DSNs and associates them with the name of the driver.&lt;br /&gt; You need to provide this section only if you use an ODBC driver manager from a third-party vendor.&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Required&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Data Source Specification&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Each DSN listed in the ODBC Data Sources section has a Data-Source Specification section that describes the DSN.&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Required&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ODBC&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;This section lists ODBC tracing options.&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Optional&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;odbcinst.ini&lt;/code&gt; íŒŒì¼ì€ ODBC driverì— ëŒ€í•œ ëª…ì„¸ë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤. ì•„ë˜ì™€ ê°™ì€ í¬ë§·ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[ODBC Drivers]
DataDirect 8.0 Oracle Wire Protocol=Installed

[DataDirect 8.0 Oracle Wire Protocol]
Driver=ODBCHOME/lib/ivora28.so
APILevel=1
ConnectFunctions=YYY
DriverODBCVer=3.52
FileUsage=0
HelpRootDirectory=ODBCHOME/help/OracleHelp
Setup=ODBCHOME/lib/ivora28.so
SQLLevel=1

[ODBC]
#This section must contain values for DSN-less connections
#if no odbc.ini file exists. If an odbc.ini file exists,
#the values from that [ODBC] section are used.

IANAAppCodePage=4
InstallDir=ODBCHOME
Trace=0
TraceFile=odbctrace.out
TraceDll=ODBCHOME/lib/ivtrc28.so
ODBCTraceMaxFileSize=102400
ODBCTraceMaxNumFiles=10
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´ì œ ì´ ì •ë³´ë“¤ì„ ì´ìš©í•´ python, Rì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ê²°í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë´…ë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;connection-to-database-in-python&quot;&gt;Connection to Database in Python&lt;/h1&gt;

&lt;h2 id=&quot;pyodbc&quot;&gt;pyodbc&lt;/h2&gt;

&lt;p&gt;ë°ì´í„°ë² ì´ìŠ¤ì™€ì˜ ì—°ê²°ì„ ìœ„í•´ ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” íŒ¨í‚¤ì§€ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;pyodbc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connstring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;autocommit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;readonly&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
               &lt;span class=&quot;n&quot;&gt;attrs_before&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-16le'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ansi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pyodbc.connect()&lt;/code&gt;ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;connstring&lt;/code&gt;, ì¦‰ â€œODBC connection stringâ€ì„ local driver managerì—ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤. connection stringì€ driver, udi, passwordì™€ ê°™ì´ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì— í•„ìš”í•œ ì •ë³´ë“¤ì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ìœ„ì—ì„œ ì‚´í´ë³´ì•˜ë“¯ì´, 1. Driverë¥¼ ëª…ì‹œí•˜ì—¬ ì—°ê²°í•˜ê±°ë‚˜ 2. ì‚¬ì „ì— ì •ì˜ëœ DSNì„ ì´ìš©í•˜ëŠ” ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Driverë¥¼ ëª…ì‹œí•˜ì—¬ ì—°ê²°&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ë¨¼ì € ì‚¬ìš©í•˜ê³ ì í•˜ëŠ” Driverê°€ ì„¤ì¹˜ë˜ì–´ìˆëŠ”ì§€ í™•ì¸í•´ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Windows&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PS&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;C:\&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Get-OdbcDriver&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# ì„¤ì¹˜ë˜ì–´ìˆëŠ” Driver ëª©ë¡ ì¶œë ¥&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Linux, MacOs&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; gyuhoonkim@GyuhooncBookAir ~ % odbcinst &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt;
unixODBC 2.3.9
DRIVERS............: /etc/odbcinst.ini
SYSTEM DATA SOURCES: /etc/odbc.ini
FILE DATA SOURCES..: /etc/ODBCDataSources
USER DATA SOURCES..: /Users/gyuhoonkim/.odbc.ini
SQLULEN Size.......: 8
SQLLEN Size........: 8
SQLSETPOSIROW Size.: 8
&lt;span class=&quot;c&quot;&gt;# /etc/odbcinst.ini ë¥¼ ì¡°íšŒí•˜ì—¬ Driver ì„¤ì¹˜ ëª©ë¡ í™•ì¸&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ODBC Driver 17 for SQL Serverê°€ ì„¤ì¹˜ë˜ì–´ìˆë‹¤ê³  ê°€ì •í•˜ë©´, ì•„ë˜ì™€ ê°™ì€ connection stringì„ ì¸ìë¡œ ì „ë‹¬í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ê²°í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyodbc&lt;/span&gt; 
&lt;span class=&quot;c1&quot;&gt;# Some other example server values are
# server = 'localhost\sqlexpress' # for a named instance
# server = 'myserver,port' # to specify an alternate port
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;server&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'tcp:myserver.database.windows.net'&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;database&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'mydb'&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;username&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'myusername'&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;password&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'mypassword'&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;cnxn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pyodbc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'DRIVER={ODBC Driver 17 for SQL Server};SERVER='&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;';DATABASE='&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;database&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;';UID='&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;';PWD='&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;autucommit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cursor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cnxn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cursor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#ì¿¼ë¦¬ ì‹¤í–‰ ê²°ê³¼
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SHOW TABLES&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cnxn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#ì¿¼ë¦¬ ì‹¤í–‰
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cursor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;
INSERT INTO SalesLT.Product (Name, ProductNumber, StandardCost, ListPrice, SellStartDate) 
VALUES (?,?,?,?,?)&quot;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;'SQL Server Express New 20'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'SQLEXPRESS New 20'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CURRENT_TIMESTAMP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rowcount&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;ì‚¬ì „ ì •ì˜ëœ DSNì„ ì´ìš©í•˜ì—¬ ì—°ê²°&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Driver Managerë¥¼ í†µí•´ ì •ì˜í•œ DSNì„ ì „ë‹¬í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¨¼ì €, ì •ì˜ëœ DSNì„ í™•ì¸í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Windows&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PS&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;C:\&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Get-OdbcDsn&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# DSN ëª©ë¡ì„ ì¶œë ¥&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Linux, MacOs&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; gyuhoonkim@GyuhooncBookAir ~ % odbcinst &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt;
unixODBC 2.3.9
DRIVERS............: /etc/odbcinst.ini
SYSTEM DATA SOURCES: /etc/odbc.ini
FILE DATA SOURCES..: /etc/ODBCDataSources
USER DATA SOURCES..: /Users/gyuhoonkim/.odbc.ini
SQLULEN Size.......: 8
SQLLEN Size........: 8
SQLSETPOSIROW Size.: 8
&lt;span class=&quot;c&quot;&gt;# /etc/odbc.ini ë¥¼ ì¡°íšŒí•˜ì—¬ DSN ëª©ë¡ í™•ì¸&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;MYMSSQL1ì´ë¼ëŠ” DSNì´ ì¡´ì¬í•œë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤. ê·¸ë¦¬ê³  í•´ë‹¹ DSNì€ ì´ë¯¸ uid, password ì •ë³´ê¹Œì§€ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;cnxn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pyodbc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'DSN=MYMSSQL1;schema=test'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;autocommit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# test schemaì— ì—°ê²°
# DSN ìƒì„± ì‹œì— UserName, Passwordê°€ ì§€ì •ë˜ì–´ì„œ ë”°ë¡œ ì ì§€ ì•Šì•„ë„ ì‹¤í–‰ë¨(ì„¤ì •ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒ)
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´ì™¸ì—ë„ databaseì— íŠ¹í™”ëœ PyMongo, PyMssql, PyHive ì™€ ê°™ì€ íŒ¨í‚¤ì§€ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ì‚¬ìš© ë°©ë²•ì€ pyodbcì™€ í¬ê²Œ ë‹¤ë¥´ì§€ ì•Šê¸° ë•Œë¬¸ì— ê° íŒ¨í‚¤ì§€ì— ëŒ€í•œ ì˜ˆì‹œëŠ” ìƒëµí•˜ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;connection-to-database-in-r&quot;&gt;Connection to Database in R&lt;/h1&gt;

&lt;p&gt;Rì€ ëª‡ ê°€ì§€ íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•´ì„œ ë°ì´í„°ë² ì´ìŠ¤ì™€ì˜ ì—°ê²°ì„ êµ¬í˜„í•©ë‹ˆë‹¤. connection stringì„ ì¡°í•©í•˜ì—¬ ì¸ìë¡œ ì „ë‹¬í•´ì•¼í•œë‹¤ëŠ” ê²ƒì€ pythonê³¼ ë˜‘ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-R highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# Connection using Driver&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'tcp:myserver.database.windows.net'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;database&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'mydb'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'myusername'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;password&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'mypassword'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DBI&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dbConnect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drv&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;odbc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;odbc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;driver&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ODBC Driver 17 for SQL Server&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;database&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;database&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pwd&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Connection using DSN&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dsn&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'MYMSSQL1'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DBI&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dbConnect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drv&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;odbc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;odbc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dsn&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dsn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;R íŒ¨í‚¤ì§€ì˜ ì¥ì ì€ pyodbcê°€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cursor.execute(query)&lt;/code&gt; ë§Œìœ¼ë¡œ í…Œì´ë¸” ì ì¬, ë“œë, ì‚½ì…ì„ ìˆ˜í–‰í•´ì•¼í•˜ëŠ” ê²ƒì— ë¹„í•´, ì¿¼ë¦¬ë¥¼ ì‘ì„±í•˜ì§€ ì•Šì•„ë„  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;data.frame&lt;/code&gt; ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ì ì¬í•˜ê±°ë‚˜, í…Œì´ë¸”ì„ ì‚­ì œí•˜ëŠ” ë“±ì˜ ê¸°ëŠ¥ì„ ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µí•œë‹¤ëŠ” ì ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;func&lt;/th&gt;
      &lt;th&gt;details&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dbReadTable()&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Copy data frames from database tables&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dbWriteTable()&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Copy data frames to database tables&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dbCreateTable()&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Create a table in the database&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dbAppendTable()&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Insert rows into a table&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dbRemoveTable()&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Remove a table from the database&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dbListTables()&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;List remote tables&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dbListFields()&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;List field names of a remote table&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dbExistsTable()&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Does a table exist?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dbListObjects()&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;List remote objects&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sqlRownamesToColumn()&lt;/code&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sqlColumnToRownames()&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;Convert row names back and forth between columns&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyodbc&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# insert data from csv file into dataframe.
# working directory for csv file: type &quot;pwd&quot; in Azure Data Studio or Linux
# working directory in Windows c:\users\username
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;c:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;username\department.csv&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Some other example server values are
# server = 'localhost\sqlexpress' # for a named instance
# server = 'myserver,port' # to specify an alternate port
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;server&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'yourservername'&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;database&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'AdventureWorks'&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;username&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'username'&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;password&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'yourpassword'&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;cnxn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pyodbc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'DRIVER={SQL Server};SERVER='&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;';DATABASE='&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;database&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;';UID='&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;';PWD='&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cursor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cnxn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cursor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Insert Dataframe into SQL Server:
# ë°˜ë³µë¬¸ì„ í†µí•´ ê° rowë¥¼ INSERT
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iterrows&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cursor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;INSERT INTO HumanResources.DepartmentTest (DepartmentID,Name,GroupName) values(?,?,?)&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DepartmentID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GroupName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cnxn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;commit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cursor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì™€ ê°™ì´ ë°˜ë³µë¬¸ì„ ì´ìš©í•´ ê° rowë¥¼ ì‚½ì…í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼í•˜ëŠ”  pyodbcì™€ ë‹¬ë¦¬,&lt;/p&gt;

&lt;div class=&quot;language-R highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'yourservername'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;database&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'AdventureWorks'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'username'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;password&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'yourpassword'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DBI&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dbConnect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drv&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;odbc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;odbc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;driver&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;SQL Server&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;database&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;database&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pwd&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read.csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;c:/user/username/department.csv&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dbAppendTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'HumanResources.DepartmentTest'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Rì—ì„œëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dbAppendTable()&lt;/code&gt; í•˜ë‚˜ë§Œìœ¼ë¡œ ìœ„ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë‹¤ìŒì—ëŠ” hive, pyhiveì— ëŒ€í•´ì„œ ì ì–´ë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;[ì°¸ê³ ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.oracle.com/database/&quot;&gt;https://docs.oracle.com/database/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.ibm.com/docs&quot;&gt;https://www.ibm.com/docs&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.microsoft.com/ko-kr/sql/?view=sql-server-ver15&quot;&gt;https://docs.microsoft.com/ko-kr/sql/?view=sql-server-ver15&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/powershell/&quot;&gt;https://docs.microsoft.com/en-us/powershell/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://dbi.r-dbi.org/reference&quot;&gt;https://dbi.r-dbi.org/reference&lt;/a&gt;&lt;/p&gt;</content><author><name>GyuhoonK</name></author><category term="database" /><summary type="html">python, Rì—ì„œ Database Serverì™€ ì—°ê²°í•˜ê¸°</summary></entry><entry><title type="html">scala</title><link href="http://localhost:4000/scala" rel="alternate" type="text/html" title="scala" /><published>2021-09-01T22:30:00+09:00</published><updated>2021-09-01T22:30:00+09:00</updated><id>http://localhost:4000/scala</id><content type="html" xml:base="http://localhost:4000/scala">&lt;p&gt;First Scala Posting&lt;/p&gt;</content><author><name>GyuhoonK</name></author><category term="scala" /><summary type="html">First Scala Posting</summary></entry><entry><title type="html">AWS S3ì™€ zip íŒŒì¼</title><link href="http://localhost:4000/python" rel="alternate" type="text/html" title="AWS S3ì™€ zip íŒŒì¼" /><published>2021-09-01T22:30:00+09:00</published><updated>2021-09-01T22:30:00+09:00</updated><id>http://localhost:4000/python</id><content type="html" xml:base="http://localhost:4000/python">&lt;p&gt;AWS S3 ë‚´ zip íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ ë°›ì§€ ì•Šê³ , ë‚´ìš©ë¬¼ë§Œ ë‹¤ìš´ë¡œë“œ ë°›ê¸°&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/aws-s3-structure.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;AWS S3 StorageëŠ” ìœ„ì™€ ê°™ì´ Bucket - Container(Folder) - Objects êµ¬ì¡°ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ëœ íŠ¹ì • íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ ë°›ê³ ì í•˜ëŠ” ê²½ìš°ì—, ë³´í†µ ì•„ë˜ì™€ ê°™ì€ ì½”ë“œë¡œ ìŠ¤í† ë¦¬ì§€ ë‚´ ì €ì¥ëœ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ ë°›ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;boto3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;boto3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'s3'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;region_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'us-east-1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;aws_acess_key_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AWS_KEY_ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;aws_secret_access_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AWS_SECRET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;download_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Bucket&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'my_bucket'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'my_container/my_file.csv'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'downloaded_file.csv'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì˜ ì˜ˆì‹œëŠ” csv íŒŒì¼ì´ê¸° ë•Œë¬¸ì—, ë¹„êµì  ê°„ë‹¨í•˜ê²Œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´, ë‹¤ìš´ë¡œë“œ ë°›ê³ ì í•˜ëŠ” objectê°€ &lt;strong&gt;zipíŒŒì¼&lt;/strong&gt;ê³¼ ê°™ì€ ì••ì¶• íŒŒì¼ì´ë¼ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œìš”?&lt;/p&gt;

&lt;p&gt;ì²˜ìŒ ë“œëŠ” ìƒê°ì€&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;zipíŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ í•œë‹¤.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;zipíŒŒì¼ì„ ì••ì¶• í•´ì œí•˜ì—¬ ì›í•˜ëŠ” íŒŒì¼ì„ ì°¾ëŠ”ë‹¤.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ì•„ë˜ì™€ ê°™ì€ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ ë¬¸ì œ ì—†ì´ ì›í•˜ëŠ” íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;## [a.csv, b.csv, c.csv] -&amp;gt; [abc.zip]ìœ¼ë¡œ ì••ì¶•ë˜ì—ˆë‹¤ê³  ê°€ì •
## a.csvë¥¼ ë‹¤ìš´ë¡œë“œ ë°›ìœ¼ë ¤ëŠ” ì½”ë“œ
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;boto3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;boto3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'s3'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;region_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'us-east-1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;aws_acess_key_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AWS_KEY_ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;aws_secret_access_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AWS_SECRET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;download_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Bucket&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'my_bucket'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;Key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'my_container/abc.zip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;Filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'downloaded_abc.zip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;zipfile&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'downloaded_abc.zip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'a.csv'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ ì½”ë“œëŠ” objectì— í•´ë‹¹í•˜ëŠ”  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;abc.zip&lt;/code&gt;ì— 3ê°œì˜ íŒŒì¼ë°–ì— ì €ì¥ë˜ì§€ ì•Šì•˜ìœ¼ë©°, ê·¸ ìš©ëŸ‰ë„ ë§¤ìš° ì‘ì•„ íš¨ìœ¨ì„±ì˜ ë¬¸ì œê°€ ì œê¸°ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ëŸ¬ë‚˜ ì•„ë˜ì™€ ê°™ì€ ìƒí™©ì´ë¼ë©´ ì–´ë–¨ê¹Œìš”?&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;abc.zip&lt;/code&gt; ë‚´ì— 10ë§Œê°œì˜ íŒŒì¼ì„ ì••ì¶•í•˜ê³  ìˆì§€ë§Œ, ë‹¤ìš´ë¡œë“œí•´ì•¼í•  íŒŒì¼ì€ zipíŒŒì¼ ë‚´ë¶€ì˜ ë”± 1ê°œì¸ ê²½ìš°&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;abc.zip&lt;/code&gt; ë‚´ì— ì••ì¶•ëœ íŒŒì¼ë“¤ì˜ ìš©ëŸ‰ì´ ë§¤ìš° í¬ê³ , ë‹¤ìš´ë¡œë“œí•´ì•¼í•  íŒŒì¼ì€ zipíŒŒì¼ ë‚´ë¶€ì˜ ë”± 1ê°œì¸ ê²½ìš°&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ìœ„ì™€ ê°™ì€ ìƒí™©ì˜ ê³µí†µì ì€ ì••ì¶• íŒŒì¼ ì „ì²´ë¥¼ ë‹¤ìš´ë¡œë“œí•  í•„ìš”ëŠ” ì—†ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ íŒŒì¼ë“¤(1ê°œë¥¼ ì œì™¸í•œ ë‚˜ë¨¸ì§€ íŒŒì¼)ì— ëŒ€í•´ì„œë„  DISK IO ì‘ì—…ì´ ìˆ˜í–‰ë˜ë¯€ë¡œ, ë¦¬ì†ŒìŠ¤ ì¸¡ë©´ì—ì„œë„ ì‹œê°„ ì¸¡ë©´ì—ì„œë„ ì†í•´ì…ë‹ˆë‹¤. ì¦‰, ì´ëŸ¬í•œ ë‘ ê°€ì§€ ìƒí™©ì—ì„œëŠ”  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;abc.zip&lt;/code&gt;íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ ë°›ëŠ” ìœ„ì˜ ì½”ë“œëŠ” ë§¤ìš° ë¹„íš¨ìœ¨ì ì´ë©° ì‹œê°„ì„ ë‚­ë¹„í•˜ê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´, &lt;strong&gt;zipíŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ ë°›ì§€ ì•Šê³ , ë‚´ë¶€ì˜ ì••ì¶•ëœ íŒŒì¼ ì¤‘ íŠ¹ì • íŒŒì¼ë§Œ ë‹¤ìš´ë¡œë“œ ë°›ì„ ìˆ˜ ìˆëŠ” ë°©ë²•ì€ ë¬´ì—‡ì¼ê¹Œìš”?&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ì´ëŸ¬í•œ ì ‘ê·¼ì„ ìœ„í•´ì„œëŠ”, ë¨¼ì € &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;boto3.resource&lt;/code&gt;  ë¡œ objectì— ì ‘ê·¼í•´ì•¼í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;object ëŠ” ë‹¤ìŒ ì½”ë“œë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;boto3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'s3'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;region_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'us-east-1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;aws_acess_key_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AWS_KEY_ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;aws_secret_access_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AWS_SECRET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'my_bucket'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;s&quot;&gt;'my_container/abc.zip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# s3.Object(bucket_name = 'my_bucket', key='my_container/abc.zip')
# A resource representing an Amazon Simple Storage Service (S3) Object 
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ì „ì²´ íŒŒì¼ ê¸¸ì´ë¥¼ ë°˜í™˜(byte)
# 123
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Range&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'bytes=1-3'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# s3_objectì˜ 1ë°”ì´íŠ¸ ~ 3ë°”ì´íŠ¸ì— í•´ë‹¹í•˜ëŠ” ë¶€ë¶„ì„ ë°˜í™˜í•©ë‹ˆë‹¤
# 1ë°”ì´íŠ¸~3ë°”ì´íŠ¸ì— í•´ë‹¹í•˜ëŠ” ë°ì´í„°ëŠ” s3_object.get(Range='bytes=1-3')['Body']ë¡œ ì „ë‹¬ë©ë‹ˆë‹¤.
# ê·¸ëŸ¼ ì–´ë””ë¶€í„° ì–´ë””ê¹Œì§€ ì½ì–´ì•¼í•˜ëŠ” ê±¸ê¹Œìš”? &amp;lt;- ìš°ë¦¬ê°€ êµ¬í˜„í•˜ê³ ì í•˜ëŠ” í•µì‹¬ì…ë‹ˆë‹¤.
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Storageë¡œë¶€í„° íŒŒì¼ì— ì ‘ê·¼í–ˆìŠµë‹ˆë‹¤. í˜„ì¬ ì ‘ê·¼í•œ objectì—ëŠ” HTTP Headerê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. í—¤ë”ë¥¼ ì œì™¸í•œ ì‹¤ì œ ë‚´ìš©ë¬¼(ì´ ê²½ìš°ì—ëŠ” ì••ì¶• íŒŒì¼ ë‚´ë¶€)ë§Œì„ ì°¾ì•„ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ZipFile&lt;/code&gt;ì—ê²Œ ì „ë‹¬í•  ìˆ˜ ìˆì–´ì•¼í•©ë‹ˆë‹¤!&lt;/p&gt;

&lt;p&gt;ì—¬ê¸°ì„œ ìš°ë¦¬ê°€ ì£¼ëª©í•´ì•¼í•  ê°’ì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;'Body':StreamingBody()&lt;/code&gt; ì…ë‹ˆë‹¤. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;StreamingBody()&lt;/code&gt;ê°ì²´ì— ì‹¤ì œ  AWS S3 Storageì— ì €ì¥ëœ object íŒŒì¼ì˜ ì •ë³´ê°€ ë‹´ê²¨ìˆìŠµë‹ˆë‹¤. ë¬¸ì œëŠ” HTTP Headerì™€ HTTP Bodyê°€ êµ¬ë¶„ë˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì ì´ì£ .&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;StreamingBody()&lt;/code&gt;ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê°ì²´ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;botocore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StreamingBody&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;raw_stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;'''Wrapper class for an http response body.
This provides a few additional conveniences that do not exist in the urllib3 model:
Set the timeout on the socket (i.e read() timeouts)
Auto validation of content length, if the amount of bytes we read does not match the content length, an exception is raised.'''&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;'''Close the underlying http response stream.'''&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;iter_chunks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chunk_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;'''Return an iterator to yield chunks of chunk_size bytes from the raw stream.'''&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;iter_lines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chunk_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keepends&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;'''Return an iterator to yield lines from the raw stream.
This is achieved by reading chunk of bytes (of size chunk_size) at a time from the raw stream, and then yielding lines from there.'''&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;'''Return the next 1k chunk from the raw stream.'''&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;'''Read at most amt bytes from the stream.
If the amt argument is omitted, read all data.'''&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;set_socket_timeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;'''Set the timeout seconds on the socket.'''&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì¦‰, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;s3.Object.get()&lt;/code&gt;ë¥¼ í†µí•´  ì–»ì–´ì§„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;StreamingBody&lt;/code&gt;ê°ì²´ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;s3.Object&lt;/code&gt; ë¥¼ í˜¸ì¶œí•œ ê²°ê³¼ë¬¼ì…ë‹ˆë‹¤. ê·¸ë¦¬ê³  í•´ë‹¹ ê°ì²´ëŠ” file-like objectë¡œ ë³´ì—¬ì§‘ë‹ˆë‹¤. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;read()&lt;/code&gt; í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ê³  ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ZipFile&lt;/code&gt;ì˜ ì •ì˜ë¥¼ ì‚´í´ë³´ë©´, Diskì— ì¡´ì¬í•˜ëŠ” íŒŒì¼(íŒŒì¼ ê²½ë¡œ)ë¿ ì•„ë‹ˆë¼, íŒŒì¼ë¥˜ ê°ì²´(file-like object)ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤ê³  ë§í•˜ê³  ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;zipfile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'r'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ZIP_STORED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;allowZip64&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compresslevel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strict_timestamps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;'''ZIP íŒŒì¼ì„ ì—½ë‹ˆë‹¤, ì—¬ê¸°ì„œ fileì€ íŒŒì¼ì— ëŒ€í•œ ê²½ë¡œ (ë¬¸ìì—´), íŒŒì¼ë¥˜ ê°ì²´ ë˜ëŠ” ê²½ë¡œë¥˜ ê°ì²´ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'''&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í—¤ë”ë¥¼ ì œì™¸í•˜ê³  ìë™ìœ¼ë¡œ Bodyë¥¼ ì°¾ì•„ì£¼ê¸¸ ê¸°ëŒ€í•˜ë©°, ìš°ë¦¬ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;StreamingBody&lt;/code&gt;ë¥¼ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;zipFile&lt;/code&gt;ì— ì¸ìë¡œ ì „ë‹¬í•´ë´…ë‹ˆë‹¤!&lt;/p&gt;

&lt;p&gt;ê·¸ëŸ¬ë‚˜, ì‹œë„í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë‚˜ì˜µë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;boto3&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;zipfile&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;boto3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'s3'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;region_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'us-east-1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;aws_acess_key_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AWS_KEY_ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;aws_secret_access_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AWS_SECRET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'my_bucket'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;s&quot;&gt;'my_container/abc.zip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;streaming_body&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Body'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Rangeë¥¼ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ì „ì²´ ë°”ì´íŠ¸ë¥¼ ì½ì–´ì˜¨ë‹¤
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;streaming_body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;namelist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Traceback (most recent call last):
  File &quot;test.py&quot;, line 9, in &amp;lt;module&amp;gt;
    with ZipFile(s3_object[&quot;Body&quot;]) as z:
  File &quot;/usr/local/Cellar/python/3.6.4_4/Frameworks/Python.framework/Versions/3.6/lib/python3.6/zipfile.py&quot;, line 1108, in __init__
    self._RealGetContents()
  File &quot;/usr/local/Cellar/python/3.6.4_4/Frameworks/Python.framework/Versions/3.6/lib/python3.6/zipfile.py&quot;, line 1171, in _RealGetContents
    endrec = _EndRecData(fp)
  File &quot;/usr/local/Cellar/python/3.6.4_4/Frameworks/Python.framework/Versions/3.6/lib/python3.6/zipfile.py&quot;, line 241, in _EndRecData
    fpin.seek(0, 2)
AttributeError: 'StreamingBody' object has no attribute 'seek'
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;seek&lt;/code&gt;ì´ë€ í•¨ìˆ˜ê°€ ì—†ì–´, í•´ë‹¹ ì••ì¶• íŒŒì¼ì„ í•´ì œí•  ìˆ˜ ì—†ë‹¤ê³  í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´, ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;seek&lt;/code&gt; í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ê³  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ZipFile&lt;/code&gt;ì„ í†µí•´ ì½ì–´ì˜¬ ìˆ˜ ìˆë„ë¡ í•´ë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë¨¼ì €, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ZipFile&lt;/code&gt;ì—ì„œ í•„ìš”í•˜ë‹¤ê³  ë§í•˜ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;seek&lt;/code&gt;ì´ë€ ì–´ë–¤ í•¨ìˆ˜ì¼ê¹Œìš”?&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;class.io.IOBase&lt;/code&gt;ì—ì„œ ì´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;seek(offset, whence=SEEK_SET)
ìŠ¤íŠ¸ë¦¼ ìœ„ì¹˜ë¥¼ ì§€ì •ëœ ë°”ì´íŠ¸ offsetìœ¼ë¡œ ë³€ê²½í•©ë‹ˆë‹¤. offsetì€ whenceê°€ ê°€ë¦¬í‚¤ëŠ” ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•´ì„ë©ë‹ˆë‹¤. whenceì˜ ê¸°ë³¸ê°’ì€ SEEK_SETì…ë‹ˆë‹¤. whenceì˜ ê°’ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:&lt;/p&gt;

  &lt;p&gt;SEEK_SET ë˜ëŠ” 0 â€“ ìŠ¤íŠ¸ë¦¼ì˜ ì‹œì‘(ê¸°ë³¸ê°’); offsetì€ 0ì´ê±°ë‚˜ ì–‘ìˆ˜ì—¬ì•¼ í•©ë‹ˆë‹¤&lt;/p&gt;

  &lt;p&gt;SEEK_CUR ë˜ëŠ” 1 â€“ í˜„ì¬ ìŠ¤íŠ¸ë¦¼ ìœ„ì¹˜; offsetì€ ìŒìˆ˜ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤&lt;/p&gt;

  &lt;p&gt;SEEK_END ë˜ëŠ” 2 â€“ ìŠ¤íŠ¸ë¦¼ì˜ ë; offsetì€ ì¼ë°˜ì ìœ¼ë¡œ ìŒìˆ˜ì…ë‹ˆë‹¤&lt;/p&gt;

  &lt;p&gt;seekable()
ìŠ¤íŠ¸ë¦¼ì´ ë¬´ì‘ìœ„ ì•¡ì„¸ìŠ¤ë¥¼ ì§€ì›í•˜ë©´ Trueë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. Falseì´ë©´, seek(), tell() ë° truncate()ê°€ OSErrorë¥¼ ë°œìƒì‹œí‚µë‹ˆë‹¤.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ì´ë¥¼ ì°¸ê³ í•˜ì—¬, ìƒˆë¡œìš´ í´ë˜ìŠ¤ë¥¼ ì •ì˜í•´ë´…ë‹ˆë‹¤&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;io&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# io.RawIOBaseëŠ” io.IOBaseë¥¼ ìƒì†í•˜ëŠ” í´ë˜ìŠ¤
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;S3File&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RawIOBase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt; 
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;seek&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;whence&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEEK_SET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;whence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEEK_SET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ì‹œì‘ ìœ„ì¹˜ë¡œë¶€í„° positionì„¤ì •
&lt;/span&gt;            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;whence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEEK_CUR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# í˜„ì¬ ìœ„ì¹˜ë¡œë¶€í„° position ì„¤ì •
&lt;/span&gt;            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;whence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEEK_END&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ë ìœ„ì¹˜ë¡œë¶€í„° offset(ìŒìˆ˜)ë§Œí¼ ëŒì•„ê°€ì„œ ì„¤ì •
&lt;/span&gt;            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content_length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ValueError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;invalid whence (%r, should be %d, %d, %d)&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;whence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEEK_SET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEEK_CUR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEEK_END&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;seekable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´ì œ, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;StreamingBody&lt;/code&gt;ë¥¼ ì½ì–´ì˜¬ ìˆ˜ ìˆì„ê¹Œìš”? ì•„ë˜ ì½”ë“œë¥¼ ì‹¤í–‰í•´ë³´ì•˜ì§€ë§Œ ì•„ì‰½ê²Œë„ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;boto3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;boto3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'s3'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;region_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'us-east-1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;aws_acess_key_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AWS_KEY_ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;aws_secret_access_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AWS_SECRET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'my_bucket'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;s&quot;&gt;'my_container/abc.zip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S3File&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;namelist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Traceback (most recent call last):
  File &quot;example.py&quot;, line 38, in &amp;lt;module&amp;gt;
    with zipfile.ZipFile(s3_file) as zf:
  File &quot;/usr/local/Cellar/python/3.6.4_4/Frameworks/Python.framework/Versions/3.6/lib/python3.6/zipfile.py&quot;, line 1108, in __init__
    self._RealGetContents()
  File &quot;/usr/local/Cellar/python/3.6.4_4/Frameworks/Python.framework/Versions/3.6/lib/python3.6/zipfile.py&quot;, line 1171, in _RealGetContents
    endrec = _EndRecData(fp)
  File &quot;/usr/local/Cellar/python/3.6.4_4/Frameworks/Python.framework/Versions/3.6/lib/python3.6/zipfile.py&quot;, line 251, in _EndRecData
    data = fpin.read()
NotImplementedError
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;read&lt;/code&gt; ë¥¼ êµ¬í˜„í•´ì£¼ì–´ì•¼í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;io.RawIOBase&lt;/code&gt; ë¥¼ ë³´ë©´ ì´ í•¨ìˆ˜ì˜ ì—­í• ì€ ë‹¤ìŒê³¼ ê°™ë‹¤ê³  í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;read(size=-1)
ê°ì²´ì—ì„œ ìµœëŒ€ size ë°”ì´íŠ¸ë¥¼ ì½ê³  ë°˜í™˜í•©ë‹ˆë‹¤. í¸ì˜ìƒ, sizeê°€ ì§€ì •ë˜ì§€ ì•Šê±°ë‚˜ -1ì´ë©´, EOFê¹Œì§€ì˜ ëª¨ë“  ë°”ì´íŠ¸ê°€ ë°˜í™˜ë©ë‹ˆë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´, í•˜ë‚˜ì˜ ì‹œìŠ¤í…œ í˜¸ì¶œë§Œ ìˆ˜í–‰ë©ë‹ˆë‹¤. ìš´ì˜ ì²´ì œ ì‹œìŠ¤í…œ í˜¸ì¶œì´ size ë°”ì´íŠ¸ ë¯¸ë§Œì„ ë°˜í™˜í•˜ë©´ size ë°”ì´íŠ¸ ë¯¸ë§Œì´ ë°˜í™˜ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
0ë°”ì´íŠ¸ê°€ ë°˜í™˜ë˜ê³ , sizeê°€ 0ì´ ì•„ë‹ˆë©´, íŒŒì¼ì˜ ëì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ê°ì²´ê°€ ë¹„ ë¸”ë¡œí‚¹ ëª¨ë“œì´ê³  ì‚¬ìš© ê°€ëŠ¥í•œ ë°”ì´íŠ¸ê°€ ì—†ìœ¼ë©´ Noneì´ ë°˜í™˜ë©ë‹ˆë‹¤.
ê¸°ë³¸ êµ¬í˜„ì€ readall()ê³¼ readinto()ë¡œ ìœ„ì„í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ì´ì œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ZipFile&lt;/code&gt; ì—ì„œ íŒŒì¼ì„ ì½ê¸° ìœ„í•´ í•„ìš”í•œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;read&lt;/code&gt;í•¨ìˆ˜ë¥¼ êµ¬í˜„í•´ë´…ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;S3File&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RawIOBase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ìœ„ì™€&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ë™ì¼&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
		&lt;span class=&quot;c1&quot;&gt;# ì¶”ê°€ ë¶€ë¶„
&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;property&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content_length&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# í•¨ìˆ˜ ì •ì˜ì— ë”°ë¼, EOFê¹Œì§€ì˜ ë°”ì´íŠ¸ë¥¼ ë°˜í™˜
&lt;/span&gt;            &lt;span class=&quot;n&quot;&gt;range_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;bytes=%d-&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seek&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;whence&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEEK_END&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# new_position ì„¤ì •
&lt;/span&gt;            &lt;span class=&quot;n&quot;&gt;new_position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# content_length(size)ë¥¼ ë„˜ê¸´ ê²½ìš°, EOFê¹Œì§€ì˜ ë°”ì´íŠ¸ë¥¼ ë°˜í™˜
&lt;/span&gt;            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
						
            &lt;span class=&quot;n&quot;&gt;range_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;bytes=%d-%d&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seek&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;whence&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEEK_CUR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
				&lt;span class=&quot;c1&quot;&gt;# rage_headerì—ì„œ ì§€ì •í•œ ë§Œí¼ë§Œ, StreamingBodyë¡œë¶€í„° ì½ì–´ë“¤ì—¬ì˜µë‹ˆë‹¤
&lt;/span&gt;        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Range&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;range_header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Body&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;readable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;read&lt;/code&gt;ê°€ êµ¬í˜„ë˜ì—ˆë¯€ë¡œ, ì´ì œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ZipFile&lt;/code&gt;ì„ ì‹¤í–‰í•˜ê²Œ ë˜ë©´, ì‚¬ìš©í•˜ëŠ” í™˜ê²½ì— ë”°ë¼ ì¼ì • Byteë¥¼ ì½ì–´ë“¤ì—¬ì˜¤ê³  í•´ë‹¹ Byteì—ì„œ ì‹¤ì œ íŒŒì¼ì´ ì¡´ì¬í•˜ëŠ” ë¶€ë¶„ì„ ì¶”ì¶œí•©ë‹ˆë‹¤. ëª‡ ë²ˆì˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;read&lt;/code&gt;ë¥¼ í†µí•´ í˜„ì¬ ìœ„ì¹˜(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;self.position&lt;/code&gt;)ì„ ë°”ê¿”ê°€ë©°&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;s3.Object&lt;/code&gt;ì—ì„œ í—¤ë”ëŠ” ì œì™¸í•˜ê³  ì••ì¶•ëœ íŒŒì¼ ë‚´ìš©ì¸  Bodyë§Œì„  ì½ì–´ë“¤ì¼ ê²ƒì…ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ì´ëŸ¬í•œ ë¶€ë¶„ê¹Œì§€ëŠ” êµ¬í˜„í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. ì§€ê¸ˆê¹Œì§€ ì‘ì—…í•œ ë‚´ìš©ì„ í†µí•´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ZipFile&lt;/code&gt;ì´ ìœ„ì˜ ê³¼ì •(í—¤ë” ìŠ¤í‚µí•˜ê¸° ìœ„í•´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;seek&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;read&lt;/code&gt;)ì„ í•˜ê¸° ìœ„í•´ í•„ìš”í•œ í•¨ìˆ˜ë¥¼ ì •ì˜í–ˆê¸° ë•Œë¬¸ì´ì£ !&lt;/p&gt;

&lt;p&gt;ì´ì œ ë‹¤ì‹œ ì½”ë“œë¥¼ ì‹¤í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;boto3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;boto3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'s3'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;region_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'us-east-1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;aws_acess_key_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AWS_KEY_ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;aws_secret_access_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AWS_SECRET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'my_bucket'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;s&quot;&gt;'my_container/abc.zip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S3File&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ì´ì œ ZipFileì€ s3_objectì˜ ë‚´ìš©ì„ ì½ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤!!
&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;namelist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# [a.csv, b.csv, c.csv]
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´ì œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ZipFile&lt;/code&gt; ì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;s3.Object&lt;/code&gt;ì—ì„œ ì••ì¶•ëœ íŒŒì¼ë§Œì„ ì½ì–´ë“¤ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤!&lt;/p&gt;

&lt;p&gt;ë‚˜ì•„ê°€, ì••ì¶• íŒŒì¼ ë‚´ì— ì–´ë–¤ íŒŒì¼ì´ ìˆëŠ”ì§€ ì•Œê³  ìˆë‹¤ë©´ ë°”ë¡œ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ ë°›ì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;boto3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;boto3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'s3'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;region_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'us-east-1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;aws_acess_key_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AWS_KEY_ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;aws_secret_access_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AWS_SECRET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'my_bucket'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;s&quot;&gt;'my_container/abc.zip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S3File&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'a.csv'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê¸°ì¡´ ë°©ë²•ì— ë¹„í•´ ë¹ ë¥¼ê¹Œìš”? ì‹¤í—˜í•´ë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# abc.zipì— 400ê°œì˜ íŒŒì¼ì„ ì••ì¶•í–ˆìŠµë‹ˆë‹¤.
# ë°©ë²• 1 : zip ë‹¤ìš´ë¡œë“œ ì´í›„ ì••ì¶• í•´ì œ
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;boto3&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;zipfile&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;boto3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'s3'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;region_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'us-east-1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;aws_acess_key_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AWS_KEY_ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;aws_secret_access_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AWS_SECRET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;download_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Bucket&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'my_bucket'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;Key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'my_container/abc.zip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;Filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'downloaded_abc.zip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'downloaded_abc.zip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'a.csv'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 9.74s ì†Œìš”
&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# ë°©ë²• 2 : ì •ì˜í•œ S3Fileì„ ì´ìš©í•˜ì—¬ zip ì••ì¶• ë‚´ í•„ìš” íŒŒì¼ë§Œ ë‹¤ìš´ë¡œë“œ
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;boto3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'s3'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;region_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'us-east-1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;aws_acess_key_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AWS_KEY_ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;aws_secret_access_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AWS_SECRET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'my_bucket'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;s&quot;&gt;'my_container/abc.zip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S3File&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'a.csv'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 475ms ì†Œìš” (ì•½ 0.5ì´ˆ)
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê±°ì˜ 20ë°° ê°€ê¹Œì´ ì†ë„ ì°¨ì´ê°€ ë‚©ë‹ˆë‹¤! ë‚˜ë¨¸ì§€ 399ê°œ íŒŒì¼ì— ëŒ€í•œ DISK IOê°€ ë°œìƒí•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì´ì£ .&lt;/p&gt;

&lt;p&gt;íŒŒì¼ ê°œìˆ˜ê°€ ë§ì„ìˆ˜ë¡, ê·¸ë¦¬ê³  ìš©ëŸ‰ì´ í´ìˆ˜ë¡ ì´ëŸ¬í•œ ì‹œê°„ ì°¨ì´ëŠ” ë” ì»¤ì§ˆ ê²ƒì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;[ì°¸ê³ ] https://alexwlchan.net/2019/02/working-with-large-s3-objects/&lt;/p&gt;</content><author><name>GyuhoonK</name></author><category term="python" /><summary type="html">AWS S3 ë‚´ zip íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ ë°›ì§€ ì•Šê³ , ë‚´ìš©ë¬¼ë§Œ ë‹¤ìš´ë¡œë“œ ë°›ê¸°</summary></entry></feed>